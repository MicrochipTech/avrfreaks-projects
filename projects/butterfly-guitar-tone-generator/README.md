# Butterfly Guitar Tone Generator

Uploaded by Special_D on 2009-03-07 11:05:00 (rating 0 out of 5)

## Summary

A standard guitar tuner is fine, if your string is already close to being in tune. But how do we get it to that point?


My project uses the AVR butterfly to generate the six guitar string tones so you can easily bring a string close to being in tune by ear alone. Final tuning can be carried out using a precision guitar tuner as normal.


The project utilizes the butterflys LCD, using Dean's LCD\_Driver code, the joystick, including a quick and dirty debounce feature, and of course phase correct PWM for tone generation over the piezo buzzer attached on PORTB, pin PB5.


The code really speaks for itself but I will just mention the calculation of PWM tone. The calculation for tone frequency is:


Tone\_Freq = Oscillator Frequency / (Clock Prescaller * Required Frequency)


A list of musical tones can be found at the following link, allowing generation of any musical tone required.


[http://www.phy.mtu.edu/~suits/no...](http://www.phy.mtu.edu/~suits/notefreqs.html)


The other point I should mention is switch debounce. Until now, I never really understood why such importance is placed on switch debounce in the forums. However, one press of the joystick left or right in my initial code soon brought me up to speed!


Basically, the slightest press of the joystick in either left or right direction was forcing the menu to move to either extreme of top or bottom.


Placing an LCD\_puts("Left") and ("Right") instruction in there showed that the joystick was indeed bouncing many times with one press.


To solve the problem quickly, I inserted a delay between the first switch check and a second switch check. The initial delay value was 2mS and I increased this until the joystick action felt right.


The results of the project are quite encouraging. When placed alongside my standard guitar tuner, the notes generated by the Butterfly are recognised correctly by the tuner.


However there are slight variations in pitch, lower notes seem sharp - up until B, and the High E is a little flat.


This could be down to the relatively cheap piezo buzzer onboard the butterfly, or maybe down to variations in oscillator frequency.


In any case, the aim of getting a guitar string as close to being the correct pitch as possible has been met.

## Compilers

- AVR Studio 4

## Tags

- Complete code with HW
- AVR Studio 4
