<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>cocoOS: os_applAPI.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css">
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.8 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>os_applAPI.h File Reference</h1><code>#include &quot;<a class="el" href="cocoos_8h.html">cocoos.h</a>&quot;</code><br>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="os__appl_a_p_i_8h.html#7d1f6736c118f92f06a5d9218e0ba977">task_suspend</a>(taskproc)&nbsp;&nbsp;&nbsp;OS_SUSPEND_TASK( taskproc )</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="os__appl_a_p_i_8h.html#6de09b7f20e384d58bbf330c19447a79">task_resume</a>(taskproc)&nbsp;&nbsp;&nbsp;OS_RESUME_TASK( taskproc )</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="os__appl_a_p_i_8h.html#576b2326d068ab852846ee612c7b954c">event_wait</a>(event)&nbsp;&nbsp;&nbsp;OS_WAIT_SINGLE_EVENT(event)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="os__appl_a_p_i_8h.html#148bf0f2ab640ccf1cf29229d61defb6">event_wait_multiple</a>(waitAll, args...)&nbsp;&nbsp;&nbsp;OS_WAIT_MULTIPLE_EVENTS( waitAll, args)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="os__appl_a_p_i_8h.html#194e9ed0f676ffc46a782754b58a0475">event_signal</a>(event)&nbsp;&nbsp;&nbsp;OS_SIGNAL_EVENT(event)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="os__appl_a_p_i_8h.html#90cd2126d49864ddb72738c12a01b34e">event_ISR_signal</a>(event)&nbsp;&nbsp;&nbsp;OS_INT_SIGNAL_EVENT(event)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="os__appl_a_p_i_8h.html#b14d890b777d3b2a9e4c83a3ec15dd31">sem_wait</a>(sem)&nbsp;&nbsp;&nbsp;OS_WAIT_SEM(sem)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="os__appl_a_p_i_8h.html#a5011c236fb03784283e6476e9ae5adb">sem_signal</a>(sem)&nbsp;&nbsp;&nbsp;OS_SIGNAL_SEM(sem)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="os__appl_a_p_i_8h.html#f7294179cef18edc6e016ef5c0fc5650">msg_post</a>(task, pMsg)&nbsp;&nbsp;&nbsp;OS_MSG_Q_POST(task, pMsg)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="os__appl_a_p_i_8h.html#89f1464763ebc2ac0bc2915ad301b25f">msg_receive</a>(ppMsg)&nbsp;&nbsp;&nbsp;OS_MSG_Q_RECEIVE( ppMsg )</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="os__appl_a_p_i_8h.html#e66288422355db64c18c53676e53eddb">msg_q_get</a>(task)&nbsp;&nbsp;&nbsp;OS_MSG_Q_GET( task )</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="os__appl_a_p_i_8h.html#dc67691f29549315143cc60ff43e2306">msg_q_give</a>(task)&nbsp;&nbsp;&nbsp;OS_MSG_Q_GIVE( task )</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="os__appl_a_p_i_8h.html#24a1c276cfb77f61f43fdd74308ad4b9">msg_q_event_wait</a>(task)&nbsp;&nbsp;&nbsp;OS_MSG_Q_EVENT_WAIT( task )</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="os__appl_a_p_i_8h.html#c19d6a48c1cb673360ae220aaf2a9d53">task_open</a>()&nbsp;&nbsp;&nbsp;OS_BEGIN</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="os__appl_a_p_i_8h.html#7912af19af4a033fd9caf27879614945">task_close</a>()&nbsp;&nbsp;&nbsp;OS_END</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="os__appl_a_p_i_8h.html#d8232a672a6d4f3a4532bea410a0b1ef">task_wait</a>(x)&nbsp;&nbsp;&nbsp;OS_WAIT_TICKS(x)</td></tr>

<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="os__appl_a_p_i_8h.html#6cc2e63d83267ff5059bf0a76b302a09">os_init</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="os__appl_a_p_i_8h.html#19c7111cf2121a69331d99dabe3e9df0">os_start</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="os__appl_a_p_i_8h.html#1d7bc0554f6b515785211dd2c3f2d3d9">os_tick</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">uint8_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="os__appl_a_p_i_8h.html#0dd35dda08098d9f347d34e597d8a03e">task_create</a> (taskproctype taskproc, uint8_t prio, Msg_t *const msgPool[], uint8_t poolSize)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">TaskState_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="os__appl_a_p_i_8h.html#5587eb98c16ed4dd2adaa8ae2f3bb1e1">task_state_get</a> (taskproctype taskproc)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">uint8_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="os__appl_a_p_i_8h.html#b9e114be01c136878fc271be2a9c45cf">task_id_get</a> (taskproctype taskproc)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="os__appl_a_p_i_8h.html#36df952f331631590dc3a982e0e8a2d4">task_kill</a> (taskproctype taskproc)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">Sem_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="os__appl_a_p_i_8h.html#aecd95706696b8ff18d5ef74d139d750">sem_bin_create</a> (uint8_t initial)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">Sem_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="os__appl_a_p_i_8h.html#9cfb5b3cc72fdaed17009a0cae7fd725">sem_counting_create</a> (uint8_t max, uint8_t initial)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">Evt_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="os__appl_a_p_i_8h.html#04ba027b0848884aa6a2f5a346444be3">event_create</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">uint8_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="os__appl_a_p_i_8h.html#e28468ad6bb58df9d34ebd5bd3daa548">event_signaling_taskId_get</a> (Evt_t ev)</td></tr>

</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
cocoOS API header file <hr><h2>Define Documentation</h2>
<a class="anchor" name="90cd2126d49864ddb72738c12a01b34e"></a><!-- doxytag: member="os_applAPI.h::event_ISR_signal" ref="90cd2126d49864ddb72738c12a01b34e" args="(event)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define event_ISR_signal          </td>
          <td>(</td>
          <td class="paramtype">event&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td>&nbsp;&nbsp;&nbsp;OS_INT_SIGNAL_EVENT(event)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Macro for signalling an event from an ISR<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>event,:</em>&nbsp;</td><td>the event to be signalled</td></tr>
  </table>
</dl>
<dl class="remark" compact><dt><b>Remarks:</b></dt><dd><b>Usage:</b> <br>
 <div class="fragment"><pre class="fragment">Evt_t evRxChar;
main() {
 ...
 evRxChar = <a class="code" href="os__appl_a_p_i_8h.html#04ba027b0848884aa6a2f5a346444be3">event_create</a>();
 ...
}

ISR (SIG_UART_RECV)
{   
        rx.data[ rx.head ] = UDR;
        <a class="code" href="os__appl_a_p_i_8h.html#90cd2126d49864ddb72738c12a01b34e">event_ISR_signal</a>( evRxChar );
        
}
</pre></div> </dd></dl>

</div>
</div><p>
<a class="anchor" name="194e9ed0f676ffc46a782754b58a0475"></a><!-- doxytag: member="os_applAPI.h::event_signal" ref="194e9ed0f676ffc46a782754b58a0475" args="(event)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define event_signal          </td>
          <td>(</td>
          <td class="paramtype">event&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td>&nbsp;&nbsp;&nbsp;OS_SIGNAL_EVENT(event)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Macro for signalling an event.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>event,:</em>&nbsp;</td><td>the event to be signalled</td></tr>
  </table>
</dl>
<dl class="remark" compact><dt><b>Remarks:</b></dt><dd><b>Usage:</b> <br>
 <div class="fragment"><pre class="fragment">Evt_t myEvent;
main() {
 ...
 myEvent = <a class="code" href="os__appl_a_p_i_8h.html#04ba027b0848884aa6a2f5a346444be3">event_create</a>();
 ...
}

<span class="keyword">static</span> <span class="keywordtype">void</span> myTask(<span class="keywordtype">void</span>) {
 <a class="code" href="os__appl_a_p_i_8h.html#c19d6a48c1cb673360ae220aaf2a9d53">task_open</a>();   
  ...
  <a class="code" href="os__appl_a_p_i_8h.html#194e9ed0f676ffc46a782754b58a0475">event_signal</a>( myEvent );
  ...
 <a class="code" href="os__appl_a_p_i_8h.html#7912af19af4a033fd9caf27879614945">task_close</a>();
}
</pre></div> </dd></dl>

</div>
</div><p>
<a class="anchor" name="576b2326d068ab852846ee612c7b954c"></a><!-- doxytag: member="os_applAPI.h::event_wait" ref="576b2326d068ab852846ee612c7b954c" args="(event)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define event_wait          </td>
          <td>(</td>
          <td class="paramtype">event&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td>&nbsp;&nbsp;&nbsp;OS_WAIT_SINGLE_EVENT(event)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Macro for wait for a single event.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>event,:</em>&nbsp;</td><td>the event to wait for</td></tr>
  </table>
</dl>
<dl class="remark" compact><dt><b>Remarks:</b></dt><dd><b>Usage:</b> <br>
 <div class="fragment"><pre class="fragment">Evt_t myEvent;
main() {
 ...
 myEvent = <a class="code" href="os__appl_a_p_i_8h.html#04ba027b0848884aa6a2f5a346444be3">event_create</a>();
 ...
}

<span class="keyword">static</span> <span class="keywordtype">void</span> myTask(<span class="keywordtype">void</span>) {
 <a class="code" href="os__appl_a_p_i_8h.html#c19d6a48c1cb673360ae220aaf2a9d53">task_open</a>();   
  ...
  <a class="code" href="os__appl_a_p_i_8h.html#576b2326d068ab852846ee612c7b954c">event_wait</a>( myEvent );
  ...
 <a class="code" href="os__appl_a_p_i_8h.html#7912af19af4a033fd9caf27879614945">task_close</a>();
}
</pre></div> </dd></dl>

</div>
</div><p>
<a class="anchor" name="148bf0f2ab640ccf1cf29229d61defb6"></a><!-- doxytag: member="os_applAPI.h::event_wait_multiple" ref="148bf0f2ab640ccf1cf29229d61defb6" args="(waitAll, args...)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define event_wait_multiple          </td>
          <td>(</td>
          <td class="paramtype">waitAll,         <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">args...&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td>&nbsp;&nbsp;&nbsp;OS_WAIT_MULTIPLE_EVENTS( waitAll, args)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Macro for wait for multiple events.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>waitAll</em>&nbsp;</td><td>1 if wait for all, 0 if wait for any event </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>args</em>&nbsp;</td><td>list of Evt_t type events</td></tr>
  </table>
</dl>
<dl class="remark" compact><dt><b>Remarks:</b></dt><dd><b>Usage:</b> <br>
 <div class="fragment"><pre class="fragment">Evt_t myEvent1;
Evt_t myEvent2;
Evt_t myEvent3;
main() {
 ...
 myEvent1 = <a class="code" href="os__appl_a_p_i_8h.html#04ba027b0848884aa6a2f5a346444be3">event_create</a>();
 myEvent2 = <a class="code" href="os__appl_a_p_i_8h.html#04ba027b0848884aa6a2f5a346444be3">event_create</a>();
 myEvent3 = <a class="code" href="os__appl_a_p_i_8h.html#04ba027b0848884aa6a2f5a346444be3">event_create</a>();
 ...
}

<span class="keyword">static</span> <span class="keywordtype">void</span> myTask(<span class="keywordtype">void</span>) {
 <a class="code" href="os__appl_a_p_i_8h.html#c19d6a48c1cb673360ae220aaf2a9d53">task_open</a>();   
  ...
  <a class="code" href="os__appl_a_p_i_8h.html#148bf0f2ab640ccf1cf29229d61defb6">event_wait_multiple</a>(1, myEvent1, myEvent2, myEvent3);
  ...
 <a class="code" href="os__appl_a_p_i_8h.html#7912af19af4a033fd9caf27879614945">task_close</a>();
}
</pre></div> </dd></dl>

</div>
</div><p>
<a class="anchor" name="f7294179cef18edc6e016ef5c0fc5650"></a><!-- doxytag: member="os_applAPI.h::msg_post" ref="f7294179cef18edc6e016ef5c0fc5650" args="(task, pMsg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define msg_post          </td>
          <td>(</td>
          <td class="paramtype">task,         <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">pMsg&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td>&nbsp;&nbsp;&nbsp;OS_MSG_Q_POST(task, pMsg)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Posts a message to the message queue of a task.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>task</em>&nbsp;</td><td>task procedure of the task that will receive the message </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>pMsg</em>&nbsp;</td><td>pointer to the message to post </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>MSG_QUEUE_UNDEF if the task could not be found or if the task has no queue<br>
 MSG_QUEUE_FULL if the message could not be posted due to full queue<br>
 MSG_QUEUE_POSTED if the message was posted<br>
 </dd></dl>
<dl class="remark" compact><dt><b>Remarks:</b></dt><dd><b>Usage:</b> <br>
 <div class="fragment"><pre class="fragment"><span class="keyword">typedef</span> <span class="keyword">struct </span>{
    Msg_t super;
    uint8_t led;
} LedMsg_t;

 
<span class="keyword">static</span> Msg_t *msgpool_1[ 16 ];


<span class="keywordtype">int</span> main(<span class="keywordtype">void</span>)
{
        ...
    <a class="code" href="os__appl_a_p_i_8h.html#0dd35dda08098d9f347d34e597d8a03e">task_create</a>( task1, 1, NULL, 0 );
    <a class="code" href="os__appl_a_p_i_8h.html#0dd35dda08098d9f347d34e597d8a03e">task_create</a>( task2, 2, msgpool_1, 16 );
    ...
        <a class="code" href="os__appl_a_p_i_8h.html#19c7111cf2121a69331d99dabe3e9df0">os_start</a>();
    <span class="keywordflow">return</span> 0;
}


<span class="keyword">static</span> <span class="keywordtype">void</span> task1(<span class="keywordtype">void</span>) {
    <span class="keyword">static</span> LedMsg_t ledMsg;

    ledMsg.super.signal = LED_SIG;
    ledMsg.led = 5;
    
    <a class="code" href="os__appl_a_p_i_8h.html#c19d6a48c1cb673360ae220aaf2a9d53">task_open</a>();
    
    <span class="keywordflow">for</span> (;;) {
        
        <a class="code" href="os__appl_a_p_i_8h.html#d8232a672a6d4f3a4532bea410a0b1ef">task_wait</a>( 3000 );
        
        <a class="code" href="os__appl_a_p_i_8h.html#e66288422355db64c18c53676e53eddb">msg_q_get</a>( task2 );
        <a class="code" href="os__appl_a_p_i_8h.html#f7294179cef18edc6e016ef5c0fc5650">msg_post</a>( task2, (Msg_t*)(&amp;ledMsg) );
        <a class="code" href="os__appl_a_p_i_8h.html#dc67691f29549315143cc60ff43e2306">msg_q_give</a>( task2 );  
    }

    <a class="code" href="os__appl_a_p_i_8h.html#7912af19af4a033fd9caf27879614945">task_close</a>();

}
</pre></div> </dd></dl>

</div>
</div><p>
<a class="anchor" name="24a1c276cfb77f61f43fdd74308ad4b9"></a><!-- doxytag: member="os_applAPI.h::msg_q_event_wait" ref="24a1c276cfb77f61f43fdd74308ad4b9" args="(task)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define msg_q_event_wait          </td>
          <td>(</td>
          <td class="paramtype">task&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td>&nbsp;&nbsp;&nbsp;OS_MSG_Q_EVENT_WAIT( task )</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Waits for the message event to be signalled.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>task</em>&nbsp;</td><td>Task procedure associated with the message queue</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>None </dd></dl>
<dl class="remark" compact><dt><b>Remarks:</b></dt><dd><b>Usage:</b> When a message is posted to or received from a message queue, the message queue event is signaled, to indicate a change of the queue state. This could be used for example, in cases where the queue was full when a message was to be posted.<br>
 <div class="fragment"><pre class="fragment"><span class="keyword">typedef</span> <span class="keyword">struct </span>{
    Msg_t super;
    uint8_t led;
} LedMsg_t;

 
<span class="keyword">static</span> Msg_t *msgpool_1[ 16 ];


<span class="keywordtype">int</span> main(<span class="keywordtype">void</span>)
{
        ...
    <a class="code" href="os__appl_a_p_i_8h.html#0dd35dda08098d9f347d34e597d8a03e">task_create</a>( task1, 1, NULL, 0 );
    <a class="code" href="os__appl_a_p_i_8h.html#0dd35dda08098d9f347d34e597d8a03e">task_create</a>( task2, 2, msgpool_1, 16 );
    ...
        <a class="code" href="os__appl_a_p_i_8h.html#19c7111cf2121a69331d99dabe3e9df0">os_start</a>();
    <span class="keywordflow">return</span> 0;
}


<span class="keyword">static</span> <span class="keywordtype">void</span> task1(<span class="keywordtype">void</span>) {
    <span class="keyword">static</span> LedMsg_t ledMsg;
    <span class="keyword">static</span> uint8_t posted;

    ledMsg.super.signal = LED_SIG;
    ledMsg.led = 5;
    
    <a class="code" href="os__appl_a_p_i_8h.html#c19d6a48c1cb673360ae220aaf2a9d53">task_open</a>();
    
    <span class="keywordflow">for</span> (;;) {
        
        <a class="code" href="os__appl_a_p_i_8h.html#d8232a672a6d4f3a4532bea410a0b1ef">task_wait</a>( 3000 );
        
        <span class="keywordflow">do</span> {
            <a class="code" href="os__appl_a_p_i_8h.html#e66288422355db64c18c53676e53eddb">msg_q_get</a>(t2);
            posted = <a class="code" href="os__appl_a_p_i_8h.html#f7294179cef18edc6e016ef5c0fc5650">msg_post</a>( task2, (Msg_t*)(&amp;ledMsg) );
    
            <span class="keywordflow">if</span> ( posted == MSG_QUEUE_FULL ) {
                <a class="code" href="os__appl_a_p_i_8h.html#24a1c276cfb77f61f43fdd74308ad4b9">msg_q_event_wait</a>( task2 );
            }
            <span class="keywordflow">else</span> {
                <a class="code" href="os__appl_a_p_i_8h.html#dc67691f29549315143cc60ff43e2306">msg_q_give</a>( task2 );
            }
        } <span class="keywordflow">while</span>( posted == MSG_QUEUE_FULL );
    }

    <a class="code" href="os__appl_a_p_i_8h.html#7912af19af4a033fd9caf27879614945">task_close</a>();

}
</pre></div> </dd></dl>

</div>
</div><p>
<a class="anchor" name="e66288422355db64c18c53676e53eddb"></a><!-- doxytag: member="os_applAPI.h::msg_q_get" ref="e66288422355db64c18c53676e53eddb" args="(task)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define msg_q_get          </td>
          <td>(</td>
          <td class="paramtype">task&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td>&nbsp;&nbsp;&nbsp;OS_MSG_Q_GET( task )</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Macro for aquiring a message queue.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>task</em>&nbsp;</td><td>Task procedure associated with the message queue</td></tr>
  </table>
</dl>
<dl class="remark" compact><dt><b>Remarks:</b></dt><dd><b>Usage:</b> Should be called before any access to a message queue. See <a class="el" href="os__appl_a_p_i_8h.html#f7294179cef18edc6e016ef5c0fc5650">msg_post()</a> example <br>
 </dd></dl>

</div>
</div><p>
<a class="anchor" name="dc67691f29549315143cc60ff43e2306"></a><!-- doxytag: member="os_applAPI.h::msg_q_give" ref="dc67691f29549315143cc60ff43e2306" args="(task)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define msg_q_give          </td>
          <td>(</td>
          <td class="paramtype">task&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td>&nbsp;&nbsp;&nbsp;OS_MSG_Q_GIVE( task )</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Macro for releasing a message queue.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>task</em>&nbsp;</td><td>Task procedure associated with the message queue</td></tr>
  </table>
</dl>
<dl class="remark" compact><dt><b>Remarks:</b></dt><dd><b>Usage:</b> Should be called after access to a message queue. See <a class="el" href="os__appl_a_p_i_8h.html#f7294179cef18edc6e016ef5c0fc5650">msg_post()</a> example <br>
 </dd></dl>

</div>
</div><p>
<a class="anchor" name="89f1464763ebc2ac0bc2915ad301b25f"></a><!-- doxytag: member="os_applAPI.h::msg_receive" ref="89f1464763ebc2ac0bc2915ad301b25f" args="(ppMsg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define msg_receive          </td>
          <td>(</td>
          <td class="paramtype">ppMsg&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td>&nbsp;&nbsp;&nbsp;OS_MSG_Q_RECEIVE( ppMsg )</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Receives a pointer to a message pointer in the message queue.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>ppMsg</em>&nbsp;</td><td>pointer to a message pointer</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>MSG_QUEUE_UNDEF if the task could not be found or if the task has no queue<br>
 MSG_QUEUE_EMPTY if the message queue was empty<br>
 MSG_QUEUE_RECEIVED if a message was received<br>
 </dd></dl>
<dl class="remark" compact><dt><b>Remarks:</b></dt><dd><b>Usage:</b> <br>
 <div class="fragment"><pre class="fragment"><span class="keyword">typedef</span> <span class="keyword">struct </span>{
    Msg_t super;
    uint8_t led;
} LedMsg_t;

 
<span class="keyword">static</span> Msg_t *msgpool_1[ 16 ];


<span class="keywordtype">int</span> main(<span class="keywordtype">void</span>)
{
        ...
    <a class="code" href="os__appl_a_p_i_8h.html#0dd35dda08098d9f347d34e597d8a03e">task_create</a>( task1, 1, NULL, 0 );
    <a class="code" href="os__appl_a_p_i_8h.html#0dd35dda08098d9f347d34e597d8a03e">task_create</a>( task2, 2, msgpool_1, 16 );
    ...
        <a class="code" href="os__appl_a_p_i_8h.html#19c7111cf2121a69331d99dabe3e9df0">os_start</a>();
    <span class="keywordflow">return</span> 0;
}


<span class="keyword">static</span> <span class="keywordtype">void</span> task2(<span class="keywordtype">void</span>) {
    Msg_t *msg;
    uint8_t led;
    <a class="code" href="os__appl_a_p_i_8h.html#c19d6a48c1cb673360ae220aaf2a9d53">task_open</a>();
    
    <span class="keywordflow">for</span> (;;) {
        
        <a class="code" href="os__appl_a_p_i_8h.html#d8232a672a6d4f3a4532bea410a0b1ef">task_wait</a>( 3000 );
        
        <a class="code" href="os__appl_a_p_i_8h.html#e66288422355db64c18c53676e53eddb">msg_q_get</a>( task2 );
        <a class="code" href="os__appl_a_p_i_8h.html#89f1464763ebc2ac0bc2915ad301b25f">msg_receive</a>( &amp;msg );
        <a class="code" href="os__appl_a_p_i_8h.html#dc67691f29549315143cc60ff43e2306">msg_q_give</a>( task2 );

        <span class="keywordflow">if</span> ( msg-&gt;signal == LED_SIG ) {
            led = ((LedMsg_t*)msg)-&gt;led;
            LED_TOGGLE( led );
        } 
    }

    <a class="code" href="os__appl_a_p_i_8h.html#7912af19af4a033fd9caf27879614945">task_close</a>();

}
</pre></div> </dd></dl>

</div>
</div><p>
<a class="anchor" name="a5011c236fb03784283e6476e9ae5adb"></a><!-- doxytag: member="os_applAPI.h::sem_signal" ref="a5011c236fb03784283e6476e9ae5adb" args="(sem)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define sem_signal          </td>
          <td>(</td>
          <td class="paramtype">sem&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td>&nbsp;&nbsp;&nbsp;OS_SIGNAL_SEM(sem)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Macro for releasing a semaphore.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>sem</em>&nbsp;</td><td>Semaphore.</td></tr>
  </table>
</dl>
<dl class="remark" compact><dt><b>Remarks:</b></dt><dd><b>Usage:</b> <br>
 <div class="fragment"><pre class="fragment">Sem_t mySem;
main() {
 ...
 mySem = sem_create( 0 );
 ...
}

<span class="keyword">static</span> <span class="keywordtype">void</span> myTask(<span class="keywordtype">void</span>) {
 <a class="code" href="os__appl_a_p_i_8h.html#c19d6a48c1cb673360ae220aaf2a9d53">task_open</a>();   
  ...
  <a class="code" href="os__appl_a_p_i_8h.html#a5011c236fb03784283e6476e9ae5adb">sem_signal</a>( mySem );
  ...
 <a class="code" href="os__appl_a_p_i_8h.html#7912af19af4a033fd9caf27879614945">task_close</a>();
}
</pre></div> </dd></dl>

</div>
</div><p>
<a class="anchor" name="b14d890b777d3b2a9e4c83a3ec15dd31"></a><!-- doxytag: member="os_applAPI.h::sem_wait" ref="b14d890b777d3b2a9e4c83a3ec15dd31" args="(sem)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define sem_wait          </td>
          <td>(</td>
          <td class="paramtype">sem&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td>&nbsp;&nbsp;&nbsp;OS_WAIT_SEM(sem)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Macro for aquiring a semaphore.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>sem</em>&nbsp;</td><td>Semaphore.</td></tr>
  </table>
</dl>
<dl class="remark" compact><dt><b>Remarks:</b></dt><dd><b>Usage:</b> <br>
 <div class="fragment"><pre class="fragment">Sem_t mySem;
main() {
 ...
 mySem = sem_create( 0 );
 ...
}

<span class="keyword">static</span> <span class="keywordtype">void</span> myTask(<span class="keywordtype">void</span>) {
 <a class="code" href="os__appl_a_p_i_8h.html#c19d6a48c1cb673360ae220aaf2a9d53">task_open</a>();   
  ...
  <a class="code" href="os__appl_a_p_i_8h.html#b14d890b777d3b2a9e4c83a3ec15dd31">sem_wait</a>( mySem );
  ...
 <a class="code" href="os__appl_a_p_i_8h.html#7912af19af4a033fd9caf27879614945">task_close</a>();
}
</pre></div> </dd></dl>

</div>
</div><p>
<a class="anchor" name="7912af19af4a033fd9caf27879614945"></a><!-- doxytag: member="os_applAPI.h::task_close" ref="7912af19af4a033fd9caf27879614945" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define task_close          </td>
          <td>(</td>
&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td>&nbsp;&nbsp;&nbsp;OS_END</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Macro for definition of task end.<p>
<dl class="remark" compact><dt><b>Remarks:</b></dt><dd><b>Usage:</b> Should be placed at the end of the task procedure <br>
 <div class="fragment"><pre class="fragment"><span class="keyword">static</span> <span class="keywordtype">void</span> myTask(<span class="keywordtype">void</span>) {
 <span class="keyword">static</span> uint8_t i;
 <a class="code" href="os__appl_a_p_i_8h.html#c19d6a48c1cb673360ae220aaf2a9d53">task_open</a>();   
  ...
  <a class="code" href="os__appl_a_p_i_8h.html#d8232a672a6d4f3a4532bea410a0b1ef">task_wait</a>( 10 );
  ...
 <a class="code" href="os__appl_a_p_i_8h.html#7912af19af4a033fd9caf27879614945">task_close</a>();
}
</pre></div> </dd></dl>

</div>
</div><p>
<a class="anchor" name="c19d6a48c1cb673360ae220aaf2a9d53"></a><!-- doxytag: member="os_applAPI.h::task_open" ref="c19d6a48c1cb673360ae220aaf2a9d53" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define task_open          </td>
          <td>(</td>
&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td>&nbsp;&nbsp;&nbsp;OS_BEGIN</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Macro for definition of task beginning.<p>
<dl class="remark" compact><dt><b>Remarks:</b></dt><dd><b>Usage:</b> Should be placed at the beginning of the task procedure <br>
 <div class="fragment"><pre class="fragment"><span class="keyword">static</span> <span class="keywordtype">void</span> myTask(<span class="keywordtype">void</span>) {
 <span class="keyword">static</span> uint8_t i;
 <a class="code" href="os__appl_a_p_i_8h.html#c19d6a48c1cb673360ae220aaf2a9d53">task_open</a>();   
  ...
  <a class="code" href="os__appl_a_p_i_8h.html#d8232a672a6d4f3a4532bea410a0b1ef">task_wait</a>( 10 );
  ...
 <a class="code" href="os__appl_a_p_i_8h.html#7912af19af4a033fd9caf27879614945">task_close</a>();
}
</pre></div> </dd></dl>

</div>
</div><p>
<a class="anchor" name="6de09b7f20e384d58bbf330c19447a79"></a><!-- doxytag: member="os_applAPI.h::task_resume" ref="6de09b7f20e384d58bbf330c19447a79" args="(taskproc)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define task_resume          </td>
          <td>(</td>
          <td class="paramtype">taskproc&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td>&nbsp;&nbsp;&nbsp;OS_RESUME_TASK( taskproc )</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Macro for resuming a task<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>taskproc</em>&nbsp;</td><td>Task procedure of the task to resume</td></tr>
  </table>
</dl>
<dl class="remark" compact><dt><b>Remarks:</b></dt><dd>The macro has no effect if the task is not in the SUSPENDED state <br>
 If the task was waiting for a semaphore when it was suspended, the task will be reset and <br>
 execution will restart from the task procedure top.<br>
 <b>Usage:</b> <br>
 <div class="fragment"><pre class="fragment"><span class="keyword">static</span> <span class="keywordtype">void</span> led_task(<span class="keywordtype">void</span>) {
 <a class="code" href="os__appl_a_p_i_8h.html#c19d6a48c1cb673360ae220aaf2a9d53">task_open</a>();   
  <span class="keywordflow">for</span>(;;) {
        led_toggle();
        <a class="code" href="os__appl_a_p_i_8h.html#d8232a672a6d4f3a4532bea410a0b1ef">task_wait</a>( 100 );
  }
 <a class="code" href="os__appl_a_p_i_8h.html#7912af19af4a033fd9caf27879614945">task_close</a>();
}


<span class="keyword">static</span> <span class="keywordtype">void</span> button_task(<span class="keywordtype">void</span>) {
 <a class="code" href="os__appl_a_p_i_8h.html#c19d6a48c1cb673360ae220aaf2a9d53">task_open</a>();
 <span class="keywordflow">for</span> (;;) {
     <span class="keywordflow">if</span> ( button_1_Pressed ) {
       <a class="code" href="os__appl_a_p_i_8h.html#7d1f6736c118f92f06a5d9218e0ba977">task_suspend</a>( led_task );
     }
     <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( button_2_Pressed ){
       <a class="code" href="os__appl_a_p_i_8h.html#6de09b7f20e384d58bbf330c19447a79">task_resume</a>( led_task );
     }
 }
 <a class="code" href="os__appl_a_p_i_8h.html#7912af19af4a033fd9caf27879614945">task_close</a>();
}


<span class="keywordtype">int</span> main( <span class="keywordtype">void</span> ) {
        ...
        <a class="code" href="os__appl_a_p_i_8h.html#0dd35dda08098d9f347d34e597d8a03e">task_create</a>( led_task, 1, msgPool, POOL_SIZE );
    <a class="code" href="os__appl_a_p_i_8h.html#0dd35dda08098d9f347d34e597d8a03e">task_create</a>( button_task, 2, NULL, 0 );
        ...
}
</pre></div> </dd></dl>

</div>
</div><p>
<a class="anchor" name="7d1f6736c118f92f06a5d9218e0ba977"></a><!-- doxytag: member="os_applAPI.h::task_suspend" ref="7d1f6736c118f92f06a5d9218e0ba977" args="(taskproc)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define task_suspend          </td>
          <td>(</td>
          <td class="paramtype">taskproc&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td>&nbsp;&nbsp;&nbsp;OS_SUSPEND_TASK( taskproc )</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Macro for suspending a task<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>taskproc</em>&nbsp;</td><td>Task procedure of the task to suspend</td></tr>
  </table>
</dl>
<dl class="remark" compact><dt><b>Remarks:</b></dt><dd>If the task to suspend is the same as the current running task, the task is immediately suspended and other tasks are scheduled to execute. If the task to suspend is another than the current task, that task is immediately put in suspended state, and the current task continues to execute. <br>
 <b>Usage:</b> <br>
 <div class="fragment"><pre class="fragment"><span class="keyword">static</span> Msg_t *msgPool[ POOL_SIZE ];

<span class="keyword">static</span> <span class="keywordtype">void</span> led_task(<span class="keywordtype">void</span>) {
 <a class="code" href="os__appl_a_p_i_8h.html#c19d6a48c1cb673360ae220aaf2a9d53">task_open</a>();   
  <span class="keywordflow">for</span>(;;) {
        led_toggle();
        <a class="code" href="os__appl_a_p_i_8h.html#d8232a672a6d4f3a4532bea410a0b1ef">task_wait</a>( 100 );
  }
 <a class="code" href="os__appl_a_p_i_8h.html#7912af19af4a033fd9caf27879614945">task_close</a>();
}


<span class="keyword">static</span> <span class="keywordtype">void</span> button_task(<span class="keywordtype">void</span>) {
 <a class="code" href="os__appl_a_p_i_8h.html#c19d6a48c1cb673360ae220aaf2a9d53">task_open</a>();
 <span class="keywordflow">for</span> (;;) {
    <span class="keywordflow">if</span> ( buttonPressed ) {
        <a class="code" href="os__appl_a_p_i_8h.html#7d1f6736c118f92f06a5d9218e0ba977">task_suspend</a>( led_task );
    }
    <a class="code" href="os__appl_a_p_i_8h.html#d8232a672a6d4f3a4532bea410a0b1ef">task_wait</a>(10);
 }
 <a class="code" href="os__appl_a_p_i_8h.html#7912af19af4a033fd9caf27879614945">task_close</a>();
}


<span class="keywordtype">int</span> main( <span class="keywordtype">void</span> ) {
    ...
    <a class="code" href="os__appl_a_p_i_8h.html#0dd35dda08098d9f347d34e597d8a03e">task_create</a>( led_task, 1, msgPool, POOL_SIZE );
    <a class="code" href="os__appl_a_p_i_8h.html#0dd35dda08098d9f347d34e597d8a03e">task_create</a>( button_task, 2, NULL, 0 );
        ...
}
</pre></div> </dd></dl>

</div>
</div><p>
<a class="anchor" name="d8232a672a6d4f3a4532bea410a0b1ef"></a><!-- doxytag: member="os_applAPI.h::task_wait" ref="d8232a672a6d4f3a4532bea410a0b1ef" args="(x)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define task_wait          </td>
          <td>(</td>
          <td class="paramtype">x&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td>&nbsp;&nbsp;&nbsp;OS_WAIT_TICKS(x)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Macro for suspending a task a specified amount of ticks. When the wait time has expired, the task is ready to execute again and will continue at the next statement when the task is scheduled to run.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>x</em>&nbsp;</td><td>Number of ticks to wait.</td></tr>
  </table>
</dl>
<dl class="remark" compact><dt><b>Remarks:</b></dt><dd><b>Usage:</b> <br>
 <div class="fragment"><pre class="fragment"><span class="keyword">static</span> <span class="keywordtype">void</span> myTask(<span class="keywordtype">void</span>) {
 <a class="code" href="os__appl_a_p_i_8h.html#c19d6a48c1cb673360ae220aaf2a9d53">task_open</a>();   
  ...
  <a class="code" href="os__appl_a_p_i_8h.html#d8232a672a6d4f3a4532bea410a0b1ef">task_wait</a>( 10 );
  ...
 <a class="code" href="os__appl_a_p_i_8h.html#7912af19af4a033fd9caf27879614945">task_close</a>();
}
</pre></div> </dd></dl>

</div>
</div><p>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="04ba027b0848884aa6a2f5a346444be3"></a><!-- doxytag: member="os_applAPI.h::event_create" ref="04ba027b0848884aa6a2f5a346444be3" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Evt_t event_create           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Creates an event.<p>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>Returns an event.</dd></dl>
<dl class="remark" compact><dt><b>Remarks:</b></dt><dd><b>Usage:</b> <br>
 An event is created by declaring a variable of type Evt_t and then assigning the <a class="el" href="os__appl_a_p_i_8h.html#04ba027b0848884aa6a2f5a346444be3">event_create()</a> return value to that variable.</dd></dl>
<div class="fragment"><pre class="fragment">       Evt_t myEvent;
       myEvent = <a class="code" href="os__appl_a_p_i_8h.html#04ba027b0848884aa6a2f5a346444be3">event_create</a>();
</pre></div> 
</div>
</div><p>
<a class="anchor" name="e28468ad6bb58df9d34ebd5bd3daa548"></a><!-- doxytag: member="os_applAPI.h::event_signaling_taskId_get" ref="e28468ad6bb58df9d34ebd5bd3daa548" args="(Evt_t ev)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t event_signaling_taskId_get           </td>
          <td>(</td>
          <td class="paramtype">Evt_t&nbsp;</td>
          <td class="paramname"> <em>ev</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Gets the Task Id of the task that signaled the event.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>ev</em>&nbsp;</td><td>event</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>Id of task that signaled the event.</dd></dl>
<dl class="remark" compact><dt><b>Remarks:</b></dt><dd><b>Usage:</b> <br>
 A task can make a call to this function when it has resumed execution after waiting for an event to find out which other task signaled the event.</dd></dl>
<div class="fragment"><pre class="fragment">       <a class="code" href="os__appl_a_p_i_8h.html#576b2326d068ab852846ee612c7b954c">event_wait</a>(event);
       signalingTask = <a class="code" href="os__appl_a_p_i_8h.html#e28468ad6bb58df9d34ebd5bd3daa548">event_signaling_taskId_get</a>(event);
       <span class="keywordflow">if</span> ( signalingTask == Task2_id ) {
         ...
       }
</pre></div> 
</div>
</div><p>
<a class="anchor" name="6cc2e63d83267ff5059bf0a76b302a09"></a><!-- doxytag: member="os_applAPI.h::os_init" ref="6cc2e63d83267ff5059bf0a76b302a09" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void os_init           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Initializes the scheduler.<p>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>None.</dd></dl>
<dl class="remark" compact><dt><b>Remarks:</b></dt><dd><b>Usage:</b> <br>
 Should be called early in system setup, before starting the task execution</dd></dl>
<div class="fragment"><pre class="fragment"><span class="keywordtype">int</span> main(<span class="keywordtype">void</span>) {
        system_init();
        <a class="code" href="os__appl_a_p_i_8h.html#6cc2e63d83267ff5059bf0a76b302a09">os_init</a>();
        ...
}
</pre></div> 
</div>
</div><p>
<a class="anchor" name="19c7111cf2121a69331d99dabe3e9df0"></a><!-- doxytag: member="os_applAPI.h::os_start" ref="19c7111cf2121a69331d99dabe3e9df0" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void os_start           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Starts the task scheduling<p>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>None.</dd></dl>
<dl class="remark" compact><dt><b>Remarks:</b></dt><dd><b>Usage:</b> <br>
 Should be the last line of main.</dd></dl>
<div class="fragment"><pre class="fragment"><span class="keywordtype">int</span> main(<span class="keywordtype">void</span>) {
        system_init();
        <a class="code" href="os__appl_a_p_i_8h.html#6cc2e63d83267ff5059bf0a76b302a09">os_init</a>();
        <a class="code" href="os__appl_a_p_i_8h.html#0dd35dda08098d9f347d34e597d8a03e">task_create</a>( myTaskProc, 1, NULL, 0 );
        ...
        <a class="code" href="os__appl_a_p_i_8h.html#19c7111cf2121a69331d99dabe3e9df0">os_start</a>();
        <span class="keywordflow">return</span> 0;
}
</pre></div> 
</div>
</div><p>
<a class="anchor" name="1d7bc0554f6b515785211dd2c3f2d3d9"></a><!-- doxytag: member="os_applAPI.h::os_tick" ref="1d7bc0554f6b515785211dd2c3f2d3d9" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void os_tick           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Tick function driving the kernel<p>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>None.</dd></dl>
<dl class="remark" compact><dt><b>Remarks:</b></dt><dd><b>Usage:</b> <br>
 Should be called periodically. Preferably from the clock tick ISR.</dd></dl>
<div class="fragment"><pre class="fragment">ISR(SIG_OVERFLOW0) {
        ...
    <a class="code" href="os__appl_a_p_i_8h.html#1d7bc0554f6b515785211dd2c3f2d3d9">os_tick</a>();  
}
</pre></div> 
</div>
</div><p>
<a class="anchor" name="aecd95706696b8ff18d5ef74d139d750"></a><!-- doxytag: member="os_applAPI.h::sem_bin_create" ref="aecd95706696b8ff18d5ef74d139d750" args="(uint8_t initial)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Sem_t sem_bin_create           </td>
          <td>(</td>
          <td class="paramtype">uint8_t&nbsp;</td>
          <td class="paramname"> <em>initial</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Creates and initializes a new binary semaphore.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>initial</em>&nbsp;</td><td>value of the semaphore</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>Returns the created semaphore.</dd></dl>
<dl class="remark" compact><dt><b>Remarks:</b></dt><dd><b>Usage:</b> <br>
 A semaphore is created by declaring a variable of type Sem_t and then assigning the sem_create(value) return value to that variable.</dd></dl>
<div class="fragment"><pre class="fragment">       Sem_t mySem;
       mySem = <a class="code" href="os__appl_a_p_i_8h.html#aecd95706696b8ff18d5ef74d139d750">sem_bin_create</a>(0);
</pre></div> 
</div>
</div><p>
<a class="anchor" name="9cfb5b3cc72fdaed17009a0cae7fd725"></a><!-- doxytag: member="os_applAPI.h::sem_counting_create" ref="9cfb5b3cc72fdaed17009a0cae7fd725" args="(uint8_t max, uint8_t initial)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Sem_t sem_counting_create           </td>
          <td>(</td>
          <td class="paramtype">uint8_t&nbsp;</td>
          <td class="paramname"> <em>max</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&nbsp;</td>
          <td class="paramname"> <em>initial</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Creates and initializes a new counting semaphore.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>max</em>&nbsp;</td><td>value of the semaphore </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>initial</em>&nbsp;</td><td>value of the semaphore</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>Returns the created semaphore.</dd></dl>
<dl class="remark" compact><dt><b>Remarks:</b></dt><dd><b>Usage:</b> <br>
 A semaphore is created by declaring a variable of type Sem_t and then assigning the sem_create(max, 0) return value to that variable.</dd></dl>
<div class="fragment"><pre class="fragment">       Sem_t mySem;
       mySem = <a class="code" href="os__appl_a_p_i_8h.html#9cfb5b3cc72fdaed17009a0cae7fd725">sem_counting_create</a>(5,0);
</pre></div> 
</div>
</div><p>
<a class="anchor" name="0dd35dda08098d9f347d34e597d8a03e"></a><!-- doxytag: member="os_applAPI.h::task_create" ref="0dd35dda08098d9f347d34e597d8a03e" args="(taskproctype taskproc, uint8_t prio, Msg_t *const msgPool[], uint8_t poolSize)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t task_create           </td>
          <td>(</td>
          <td class="paramtype">taskproctype&nbsp;</td>
          <td class="paramname"> <em>taskproc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&nbsp;</td>
          <td class="paramname"> <em>prio</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Msg_t *const &nbsp;</td>
          <td class="paramname"> <em>msgPool</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&nbsp;</td>
          <td class="paramname"> <em>poolSize</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Creates a task scheduled by the os. The task is put in the ready state.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>taskproc</em>&nbsp;</td><td>Function pointer to the task procedure. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>prio</em>&nbsp;</td><td>Task priority on a scale 0-255 where 0 is the highest priority. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>msgPool</em>&nbsp;</td><td>Pointer to the message pool, containing pointer to messages. Ignored if poolSize is 0. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>poolSize</em>&nbsp;</td><td>Size of the message pool. Set to 0 if no message pool needed for the task</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>Task id of the created task.</dd></dl>
<dl class="remark" compact><dt><b>Remarks:</b></dt><dd><b>Usage:</b> <br>
 Should be called early in system setup, before starting the task execution. Only one task per priority level is allowed.</dd></dl>
<div class="fragment"><pre class="fragment"><span class="keyword">static</span> uint8_t taskId;
<span class="keyword">static</span> Msg_t *msgpool_1[ POOL_SIZE ];

<span class="keywordtype">int</span> main(<span class="keywordtype">void</span>) {
        system_init();
        <a class="code" href="os__appl_a_p_i_8h.html#6cc2e63d83267ff5059bf0a76b302a09">os_init</a>();
        taskId = <a class="code" href="os__appl_a_p_i_8h.html#0dd35dda08098d9f347d34e597d8a03e">task_create</a>( myTaskProc, 1, msgpool_1, POOL_SIZE );
        ...
}
</pre></div> 
</div>
</div><p>
<a class="anchor" name="b9e114be01c136878fc271be2a9c45cf"></a><!-- doxytag: member="os_applAPI.h::task_id_get" ref="b9e114be01c136878fc271be2a9c45cf" args="(taskproctype taskproc)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t task_id_get           </td>
          <td>(</td>
          <td class="paramtype">taskproctype&nbsp;</td>
          <td class="paramname"> <em>taskproc</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Gets the task id of the task associated with the specified task procedure<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>taskproc</em>&nbsp;</td><td>Function pointer to the task procedure.</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>TaskId of the task</dd></dl>
<div class="fragment"><pre class="fragment"><span class="keyword">static</span> <span class="keywordtype">void</span> waitingTask(<span class="keywordtype">void</span>)
{
    <a class="code" href="os__appl_a_p_i_8h.html#c19d6a48c1cb673360ae220aaf2a9d53">task_open</a>()

    <a class="code" href="os__appl_a_p_i_8h.html#576b2326d068ab852846ee612c7b954c">event_wait</a>( event );

    if ( event_signaling_taskId_get( event ) == task_id_get( signalingTask1 ) ) {
        ...
    }

        <a class="code" href="os__appl_a_p_i_8h.html#7912af19af4a033fd9caf27879614945">task_close</a>();

}


<span class="keyword">static</span> <span class="keywordtype">void</span> signalingTask1(<span class="keywordtype">void</span>)
{
        <a class="code" href="os__appl_a_p_i_8h.html#c19d6a48c1cb673360ae220aaf2a9d53">task_open</a>();    
        
        <a class="code" href="os__appl_a_p_i_8h.html#d8232a672a6d4f3a4532bea410a0b1ef">task_wait</a>( 900 );
       
    <a class="code" href="os__appl_a_p_i_8h.html#194e9ed0f676ffc46a782754b58a0475">event_signal</a>(event);

        <a class="code" href="os__appl_a_p_i_8h.html#7912af19af4a033fd9caf27879614945">task_close</a>();

}
</pre></div> 
</div>
</div><p>
<a class="anchor" name="36df952f331631590dc3a982e0e8a2d4"></a><!-- doxytag: member="os_applAPI.h::task_kill" ref="36df952f331631590dc3a982e0e8a2d4" args="(taskproctype taskproc)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void task_kill           </td>
          <td>(</td>
          <td class="paramtype">taskproctype&nbsp;</td>
          <td class="paramname"> <em>taskproc</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Puts the task associated with the specified task procedure in the killed state. A killed task, cannot be resumed.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>taskproc</em>&nbsp;</td><td>Function pointer to the task procedure.</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>None</dd></dl>
<div class="fragment"><pre class="fragment"><span class="keyword">static</span> <span class="keywordtype">void</span> waitingTask(<span class="keywordtype">void</span>)
{
    <a class="code" href="os__appl_a_p_i_8h.html#c19d6a48c1cb673360ae220aaf2a9d53">task_open</a>();

    <a class="code" href="os__appl_a_p_i_8h.html#576b2326d068ab852846ee612c7b954c">event_wait</a>( event );

    <span class="keywordflow">if</span> ( <a class="code" href="os__appl_a_p_i_8h.html#e28468ad6bb58df9d34ebd5bd3daa548">event_signaling_taskId_get</a>( event ) == <a class="code" href="os__appl_a_p_i_8h.html#b9e114be01c136878fc271be2a9c45cf">task_id_get</a>( signalingTask1 ) ) {
        <a class="code" href="os__appl_a_p_i_8h.html#36df952f331631590dc3a982e0e8a2d4">task_kill</a>( signalingTask1 );
    }

        <a class="code" href="os__appl_a_p_i_8h.html#7912af19af4a033fd9caf27879614945">task_close</a>();

}


<span class="keyword">static</span> <span class="keywordtype">void</span> signalingTask1(<span class="keywordtype">void</span>)
{
        <a class="code" href="os__appl_a_p_i_8h.html#c19d6a48c1cb673360ae220aaf2a9d53">task_open</a>();    
        
        <a class="code" href="os__appl_a_p_i_8h.html#d8232a672a6d4f3a4532bea410a0b1ef">task_wait</a>( 900 );
       
    <a class="code" href="os__appl_a_p_i_8h.html#194e9ed0f676ffc46a782754b58a0475">event_signal</a>(event);

        <a class="code" href="os__appl_a_p_i_8h.html#7912af19af4a033fd9caf27879614945">task_close</a>();

}
</pre></div> 
</div>
</div><p>
<a class="anchor" name="5587eb98c16ed4dd2adaa8ae2f3bb1e1"></a><!-- doxytag: member="os_applAPI.h::task_state_get" ref="5587eb98c16ed4dd2adaa8ae2f3bb1e1" args="(taskproctype taskproc)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TaskState_t task_state_get           </td>
          <td>(</td>
          <td class="paramtype">taskproctype&nbsp;</td>
          <td class="paramname"> <em>taskproc</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Gets the current state of the task associated with the specified procedure<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>taskproc</em>&nbsp;</td><td>Function pointer to the task procedure.</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>State of the task</dd></dl>
<div class="fragment"><pre class="fragment"><span class="keyword">static</span> <span class="keywordtype">void</span> led_task500(<span class="keywordtype">void</span>)
{
    <a class="code" href="os__appl_a_p_i_8h.html#c19d6a48c1cb673360ae220aaf2a9d53">task_open</a>();        
    
    <span class="keywordflow">for</span> (;;) {
        LED_TOGGLE(0);
        
        <a class="code" href="os__appl_a_p_i_8h.html#d8232a672a6d4f3a4532bea410a0b1ef">task_wait</a>( 500 );
    }

    <a class="code" href="os__appl_a_p_i_8h.html#7912af19af4a033fd9caf27879614945">task_close</a>();
}


<span class="keyword">static</span> <span class="keywordtype">void</span> led_task1000(<span class="keywordtype">void</span>)
{
    <a class="code" href="os__appl_a_p_i_8h.html#c19d6a48c1cb673360ae220aaf2a9d53">task_open</a>();        

    <span class="keywordflow">for</span> (;;) {
        <a class="code" href="os__appl_a_p_i_8h.html#b14d890b777d3b2a9e4c83a3ec15dd31">sem_wait</a>( buttonSem );

        <span class="keywordflow">if</span> ( buttonPressed ) {
            <span class="keywordflow">if</span> ( SUSPENDED &lt; <a class="code" href="os__appl_a_p_i_8h.html#5587eb98c16ed4dd2adaa8ae2f3bb1e1">task_state_get</a>( led_task500 ) ) {
                <a class="code" href="os__appl_a_p_i_8h.html#7d1f6736c118f92f06a5d9218e0ba977">task_suspend</a>( led_task500 );
            }

        }
        <span class="keywordflow">else</span> {
            <span class="keywordflow">if</span> ( SUSPENDED == <a class="code" href="os__appl_a_p_i_8h.html#5587eb98c16ed4dd2adaa8ae2f3bb1e1">task_state_get</a>( led_task500 ) ) {
                <a class="code" href="os__appl_a_p_i_8h.html#6de09b7f20e384d58bbf330c19447a79">task_resume</a>( led_task500 );
            }
        }

        <a class="code" href="os__appl_a_p_i_8h.html#a5011c236fb03784283e6476e9ae5adb">sem_signal</a>( buttonSem );

        LED_TOGGLE(1);


        <a class="code" href="os__appl_a_p_i_8h.html#d8232a672a6d4f3a4532bea410a0b1ef">task_wait</a>( 900 );
    }

    <a class="code" href="os__appl_a_p_i_8h.html#7912af19af4a033fd9caf27879614945">task_close</a>();

}
</pre></div> 
</div>
</div><p>
</div>
<hr size="1"><address style="text-align: right;"><small>Generated on Sun Nov 14 20:00:25 2010 for cocoOS by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.8 </small></address>
</body>
</html>
