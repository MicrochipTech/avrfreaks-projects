<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>AVR-Kryptoknight: authenticate.c File Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.2 -->
<div class="qindex"><a class="qindex" href="main.html">Main&nbsp;Page</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a></div>
<h1>authenticate.c File Reference</h1><code>#include "<a class="el" href="define_8h-source.html">define.h</a>"</code><br>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="define_8h.html#a11">AUTH_ERROR</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="authenticate_8c.html#a5">authenticate</a> (<a class="el" href="define_8h.html#a3">byte</a> me[4], <a class="el" href="define_8h.html#a3">byte</a> other[4], <a class="el" href="define_8h.html#a3">byte</a> message[19])</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="authenticate_8c.html#a6">dataRXready</a> (<a class="el" href="define_8h.html#a3">byte</a> *buffer, <a class="el" href="define_8h.html#a3">byte</a> length)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="authenticate_8c.html#a7">retransmit</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="authenticate_8c.html#a8">noAnswer</a> (void)</td></tr>

<tr><td colspan="2"><br><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">volatile <a class="el" href="struct_f_l_a_g_s.html">FLAGS</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="authenticate_8c.html#a4">flags</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">contains some flags (see <a class="el" href="define_8h.html">define.h</a>)  <a href="#a4"></a><br></td></tr>
</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
Routines that implement the IBM-Kryptoknight authentication protocol. <hr><h2>Function Documentation</h2>
<a class="anchor" name="a5" doxytag="authenticate.c::authenticate"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="define_8h.html#a11">AUTH_ERROR</a> authenticate           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="define_8h.html#a3">byte</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>me</em>[4], </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="define_8h.html#a3">byte</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>other</em>[4], </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="define_8h.html#a3">byte</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>message</em>[19]</td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function contains the authentication algorithm according to the IBM-Kryptoknight algorithm. This function can only perform the function of ALICE, i.e. this function always starts the authentication procedure. The procedure consists of three flows or messages. Every flow contains the address of the sender, followed by the address of the receiver. In the first flow, a nonce (=large random number) and a MESSAGE are attached. This message, generated by our ALICE is sent to BOB. In the second flow, this function receives a packet from BOB and checks the contents. This flow 2 package contains the two addresses, followed by a nonce nB generated by BOB, followed by an HMAC. This HMAC is calculated over the nonce nA, the MESSAGE, nB and the and the BOB address. If the HMAC is correct, then generate the third flow package. This package is again consituted of the two addresses, followed by an HMAC. Now the HMAC is calculated over nA and nB <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>me</em>&nbsp;</td><td>my address consisting of four bytes (e.g. IP-number) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>other</em>&nbsp;</td><td>address of the other party, also four bytes </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>message</em>&nbsp;</td><td>message to send, consisting of nineteen bytes </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>an error code indicating the status of this function </dd></dl>
    </td>
  </tr>
</table>
<a class="anchor" name="a6" doxytag="authenticate.c::dataRXready"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void dataRXready           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="define_8h.html#a3">byte</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>buffer</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="define_8h.html#a3">byte</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>length</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Function called by the NeoRS232-routines that take care of the lower level RS232 communications. DataRXready sets the flag that lets function authenticate know that data has arrived. Pointer p_RX is also set to point to the received data buffer. When the size of the data is wrong, then a communication error flag is set. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>buffer</em>&nbsp;</td><td>Buffer containing received data </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>length</em>&nbsp;</td><td>length of received data </td></tr>
  </table>
</dl>
    </td>
  </tr>
</table>
<a class="anchor" name="a8" doxytag="authenticate.c::noAnswer"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void noAnswer           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Function called by NeoRS232-routines when no acknowledge is received after several trials.     </td>
  </tr>
</table>
<a class="anchor" name="a7" doxytag="authenticate.c::retransmit"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void retransmit           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Function called by NeoRS232-routines when no acknowledge is received after sending a package. This function could resend the data.     </td>
  </tr>
</table>
<hr><h2>Variable Documentation</h2>
<a class="anchor" name="a4" doxytag="authenticate.c::flags"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">volatile <a class="el" href="struct_f_l_a_g_s.html">FLAGS</a> <a class="el" href="random_8c.html#a3">flags</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
contains some flags (see <a class="el" href="define_8h.html">define.h</a>) 
<p>
<dl compact><dt><b>See also:</b></dt><dd><a class="el" href="define_8h.html">define.h</a>) </dd></dl>
    </td>
  </tr>
</table>
<hr size="1"><address style="align: right;"><small>Generated on Wed Jun 1 20:52:32 2005 for AVR-Kryptoknight by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.2 </small></address>
</body>
</html>
