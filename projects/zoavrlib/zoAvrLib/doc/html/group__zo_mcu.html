<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>01 Mechatronics Avr Library: zoMcu.h : Global-interrupt-enable-bit manipulation macros</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.3 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>zoMcu.h : Global-interrupt-enable-bit manipulation macros<br/>
<small>
[<a class="el" href="group__soft.html">Software utilities</a>]</small>
</h1><table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga68c330e94fe121eba993e5a5973c3162"></a><!-- doxytag: member="zoMcu::cli" ref="ga68c330e94fe121eba993e5a5973c3162" args="()" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__zo_mcu.html#ga68c330e94fe121eba993e5a5973c3162">cli</a>()&nbsp;&nbsp;&nbsp;__asm__ __volatile__ (&quot;cli&quot; ::)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Disable global interrupts by directly reseting the global-interrupt-enable bit. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="gaad5ebd34cb344c26ac87594f79b06b73"></a><!-- doxytag: member="zoMcu::sei" ref="gaad5ebd34cb344c26ac87594f79b06b73" args="()" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__zo_mcu.html#gaad5ebd34cb344c26ac87594f79b06b73">sei</a>()&nbsp;&nbsp;&nbsp;__asm__ __volatile__ (&quot;sei&quot; ::)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Enable global inteerupt by directly setting the global-interrupt-enable bit. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__zo_mcu.html#ga4bbb64be9c2c27f436bf05995a16c9a5">enterCritical</a>()</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Store the status register in the stack and then reset the global-interrupt-enable bit.  <a href="#ga4bbb64be9c2c27f436bf05995a16c9a5"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__zo_mcu.html#ga7eaf5d3dbc6a31a449a914428e2d1963">exitCritical</a>()</td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<dl class="user"><dt><b>Overview</b></dt><dd>This file contains macros for manipulation of the global interrupt enable bit in the CPU status register. These macros are mainly used to protect global variables from being corrupted by ISR code. The use of the <a class="el" href="group__zo_mcu.html#ga4bbb64be9c2c27f436bf05995a16c9a5" title="Store the status register in the stack and then reset the global-interrupt-enable...">enterCritical()</a> and <a class="el" href="group__zo_mcu.html#ga7eaf5d3dbc6a31a449a914428e2d1963">exitCritical()</a> macros is recommended as they do not disturb the previous state of the global interrupt bit . These macros use the stack as storage for the CPU status register, so it is obligatory to call them in pairs. ie an <a class="el" href="group__zo_mcu.html#ga4bbb64be9c2c27f436bf05995a16c9a5" title="Store the status register in the stack and then reset the global-interrupt-enable...">enterCritical()</a> must ALWAYS be followed by an <a class="el" href="group__zo_mcu.html#ga7eaf5d3dbc6a31a449a914428e2d1963">exitCritical()</a> macro. Otherwise the stack will be corrupted with unpredictable results.</dd></dl>
<dl class="user"><dt><b>Usage example </b></dt><dd><div class="fragment"><pre class="fragment"><span class="preprocessor"> #include &quot;<a class="code" href="zo_mcu_8h.html" title="Mcu global-interrupt-enable-bit manipulation macros.">zoMcu.h</a>&quot;</span>

 <a class="code" href="group__zo_types.html#gace9d960e74685e2cd84b36132dbbf8aa" title="unsigned 16-bit integer">u16</a> MyGlobalVariable = 0;

 <span class="keywordtype">int</span> main(<span class="keywordtype">void</span>)
 {
    <a class="code" href="group__zo_mcu.html#ga4bbb64be9c2c27f436bf05995a16c9a5" title="Store the status register in the stack and then reset the global-interrupt-enable...">enterCritical</a>();                            <span class="comment">//protect global from ISR interference</span>
    MyGlobalVariable = MyGlobalVariable + 1;    <span class="comment">//manipulate global variable </span>
    <a class="code" href="group__zo_mcu.html#ga7eaf5d3dbc6a31a449a914428e2d1963">exitCritical</a>();                             <span class="comment">//allow ISRs to do their job</span>
 }
</pre></div> </dd></dl>
<hr/><h2>Define Documentation</h2>
<a class="anchor" id="ga4bbb64be9c2c27f436bf05995a16c9a5"></a><!-- doxytag: member="zoMcu.h::enterCritical" ref="ga4bbb64be9c2c27f436bf05995a16c9a5" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define enterCritical</td>
          <td>(</td>
&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<b>Value:</b><div class="fragment"><pre class="fragment">__asm__ __volatile__ (<span class="stringliteral">&quot;in __tmp_reg__, __SREG__\n\t &quot;</span> \
                      <span class="stringliteral">&quot;push __tmp_reg__\n\t&quot;</span> \
                      <span class="stringliteral">&quot;cli&quot;</span> ::)
</pre></div>
<p>Store the status register in the stack and then reset the global-interrupt-enable bit. </p>

</div>
</div>
<a class="anchor" id="ga7eaf5d3dbc6a31a449a914428e2d1963"></a><!-- doxytag: member="zoMcu.h::exitCritical" ref="ga7eaf5d3dbc6a31a449a914428e2d1963" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define exitCritical</td>
          <td>(</td>
&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<b>Value:</b><div class="fragment"><pre class="fragment">__asm__ __volatile__ (<span class="stringliteral">&quot;pop __tmp_reg__ \n\t&quot;</span> \
                      <span class="stringliteral">&quot;out __SREG__, __tmp_reg__&quot;</span> ::)
</pre></div><p>Restore the status register from the stack, leaving interrupts at the state they were before the <a class="el" href="group__zo_mcu.html#ga4bbb64be9c2c27f436bf05995a16c9a5" title="Store the status register in the stack and then reset the global-interrupt-enable...">enterCritical()</a> macro </p>

</div>
</div>
</div>
<hr class="footer"/><address style="text-align: right;"><small>Generated on Mon Mar 22 16:32:12 2010 for 01 Mechatronics Avr Library by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.3 </small></address>
</body>
</html>
