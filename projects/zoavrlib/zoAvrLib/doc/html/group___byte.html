<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>01 Mechatronics Avr Library: ring buffers for error storage</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.3 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>ring buffers for error storage<br/>
<small>
[<a class="el" href="group__soft.html">General Libraries</a>]</small>
</h1><table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Data Structures</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_z_o___e_r_r_o_r.html">ZO_ERROR</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Error buffer type.  <a href="struct_z_o___e_r_r_o_r.html#_details">More...</a><br/></td></tr>
<tr><td colspan="2"><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="gaa723add25ef376452f139ed1a2031d0b"></a><!-- doxytag: member="Byte::ZO_ERROR_STORAGE_SIZE" ref="gaa723add25ef376452f139ed1a2031d0b" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___byte.html#gaa723add25ef376452f139ed1a2031d0b">ZO_ERROR_STORAGE_SIZE</a>&nbsp;&nbsp;&nbsp;8</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Size of an error buffer. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="gae5ab1d9c29b11ba4739316fdc9f74a10"></a><!-- doxytag: member="Byte::ZO_ERROR_DEFAULTS" ref="gae5ab1d9c29b11ba4739316fdc9f74a10" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___byte.html#gae5ab1d9c29b11ba4739316fdc9f74a10">ZO_ERROR_DEFAULTS</a>&nbsp;&nbsp;&nbsp;{0,0,0,{0,0,0,0,0,0,0,0}}</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Default error buffer initializer. <br/></td></tr>
<tr><td colspan="2"><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___byte.html#ga64a80a1610edf235a729b7969d1c2721">zoErrorInit</a> (<a class="el" href="struct_z_o___e_r_r_o_r.html">ZO_ERROR</a> *p)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Initializes the error buffer. Always call this function before calling any other function of this library.  <a href="#ga64a80a1610edf235a729b7969d1c2721"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__zo_types.html#ga6fb566012d3df25f99176f5b77c04693">u08</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___byte.html#gafbe72b7d73146fe8a4e2082d0d51c6b8">zoErrorGet</a> (<a class="el" href="struct_z_o___e_r_r_o_r.html">ZO_ERROR</a> *p)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Gets the 'oldest' error code stored in the error buffer.  <a href="#gafbe72b7d73146fe8a4e2082d0d51c6b8"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___byte.html#ga9f86f4bc1e454eed4be55c523ba161fe">zoErrorPut</a> (<a class="el" href="struct_z_o___e_r_r_o_r.html">ZO_ERROR</a> *p, const <a class="el" href="group__zo_types.html#ga6fb566012d3df25f99176f5b77c04693">u08</a> error)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Puts an error code in the error buffer.  <a href="#ga9f86f4bc1e454eed4be55c523ba161fe"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__zo_types.html#ga6156fe0b594c9754f386f6c6a30c8165">bool</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___byte.html#ga64fa10670838d38c9a8e7139a40a9cbc">zoErrorIsEmpty</a> (<a class="el" href="struct_z_o___e_r_r_o_r.html">ZO_ERROR</a> *p)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Checks if the error buffer is empty.  <a href="#ga64fa10670838d38c9a8e7139a40a9cbc"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="gaf0c83e128b014f1cf216d0788e48f9b7"></a><!-- doxytag: member="Byte::zoErrorGetIsr" ref="gaf0c83e128b014f1cf216d0788e48f9b7" args="(ZO_ERROR *p)" -->
<a class="el" href="group__zo_types.html#ga6fb566012d3df25f99176f5b77c04693">u08</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___byte.html#gaf0c83e128b014f1cf216d0788e48f9b7">zoErrorGetIsr</a> (<a class="el" href="struct_z_o___e_r_r_o_r.html">ZO_ERROR</a> *p)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Unprotected inline version of <a class="el" href="group___byte.html#gafbe72b7d73146fe8a4e2082d0d51c6b8" title="Gets the &#39;oldest&#39; error code stored in the error buffer.">zoErrorGet()</a> for use in ISRs. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga1583f87beaf0c848c4700b8f24c3e90d"></a><!-- doxytag: member="Byte::zoErrorPutIsr" ref="ga1583f87beaf0c848c4700b8f24c3e90d" args="(ZO_ERROR *p, const u08 error)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___byte.html#ga1583f87beaf0c848c4700b8f24c3e90d">zoErrorPutIsr</a> (<a class="el" href="struct_z_o___e_r_r_o_r.html">ZO_ERROR</a> *p, const <a class="el" href="group__zo_types.html#ga6fb566012d3df25f99176f5b77c04693">u08</a> error)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Unprotected inline version of <a class="el" href="group___byte.html#ga9f86f4bc1e454eed4be55c523ba161fe" title="Puts an error code in the error buffer.">zoErrorPut()</a> for use in ISRs. <br/></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<dl class="user"><dt><b>Overview</b></dt><dd>This library has an identical implementation with the zoBuffer library. Naming is the main difference. These 'special' ring buffers with a predefined fixed size of 8 bytes are used to store errors that occur during execution of any zoAvrLib .c file. In this way the error handling code is more apparent to the reader. This implementation was chosen because of the ability to safely handle errors that might be recognized in ISRs.See the error handling section in the documentation of zoAvrLib, or the way zoError functions are used in zoAvrLib source code for more info.</dd></dl>
<dl class="user"><dt><b>Usage example </b></dt><dd><div class="fragment"><pre class="fragment"><span class="preprocessor"> #include &quot;<a class="code" href="zo_error_8h.html" title="Byte ring buffer used for error storage.">zoError.h</a>&quot;</span>
<span class="preprocessor"> #include &quot;<a class="code" href="zo_types_8h.html" title="Types used in zoAvrLib.">zoTypes.h</a>&quot;</span>

<span class="preprocessor"> #define SOMETHING_WENT_WRONG_ERROR_CODE 0x01</span>
<span class="preprocessor"></span>
 <a class="code" href="struct_z_o___e_r_r_o_r.html" title="Error buffer type.">ZO_ERROR</a> MyError = <a class="code" href="group___byte.html#gae5ab1d9c29b11ba4739316fdc9f74a10" title="Default error buffer initializer.">ZO_ERROR_DEFAULTS</a>;    <span class="comment">//declare a global error buffer</span>

 <span class="keywordtype">void</span> myLibraryInit(<span class="keywordtype">void</span>)
    {
        <a class="code" href="group___byte.html#ga64a80a1610edf235a729b7969d1c2721" title="Initializes the error buffer. Always call this function before calling any other...">zoErrorInit</a>(&amp;MyError);
        doThis();
        doThat();
 }

 <span class="keywordtype">bool</span> myFunction(<span class="keywordtype">void</span>)
 {
    <span class="keywordflow">if</span>(somethingWentWrong)
    {
        <a class="code" href="group___byte.html#ga9f86f4bc1e454eed4be55c523ba161fe" title="Puts an error code in the error buffer.">zoErrorPut</a>(&amp;MyError, SOMETHING_WENT_WRONG_ERROR_CODE);
        <span class="keywordflow">return</span> <span class="keyword">false</span>;
    }
 <span class="keywordflow">return</span> <span class="keyword">true</span>;
 }
</pre></div> </dd></dl>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="ga64a80a1610edf235a729b7969d1c2721"></a><!-- doxytag: member="zoError.h::zoErrorInit" ref="ga64a80a1610edf235a729b7969d1c2721" args="(ZO_ERROR *p)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void zoErrorInit </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_z_o___e_r_r_o_r.html">ZO_ERROR</a> *&nbsp;</td>
          <td class="paramname"> <em>p</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Initializes the error buffer. Always call this function before calling any other function of this library. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>*p</em>&nbsp;</td><td>Pointer to the error buffer variable. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="gafbe72b7d73146fe8a4e2082d0d51c6b8"></a><!-- doxytag: member="zoError.h::zoErrorGet" ref="gafbe72b7d73146fe8a4e2082d0d51c6b8" args="(ZO_ERROR *p)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__zo_types.html#ga6fb566012d3df25f99176f5b77c04693">u08</a> zoErrorGet </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_z_o___e_r_r_o_r.html">ZO_ERROR</a> *&nbsp;</td>
          <td class="paramname"> <em>p</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Gets the 'oldest' error code stored in the error buffer. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>*p</em>&nbsp;</td><td>Pointer to the error buffer variable. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ga9f86f4bc1e454eed4be55c523ba161fe"></a><!-- doxytag: member="zoError.h::zoErrorPut" ref="ga9f86f4bc1e454eed4be55c523ba161fe" args="(ZO_ERROR *p, const u08 error)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void zoErrorPut </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_z_o___e_r_r_o_r.html">ZO_ERROR</a> *&nbsp;</td>
          <td class="paramname"> <em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="group__zo_types.html#ga6fb566012d3df25f99176f5b77c04693">u08</a>&nbsp;</td>
          <td class="paramname"> <em>error</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Puts an error code in the error buffer. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>*p</em>&nbsp;</td><td>Pointer to the error buffer variable. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>error</em>&nbsp;</td><td>The error code to be stored in the error buffer </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ga64fa10670838d38c9a8e7139a40a9cbc"></a><!-- doxytag: member="zoError.h::zoErrorIsEmpty" ref="ga64fa10670838d38c9a8e7139a40a9cbc" args="(ZO_ERROR *p)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__zo_types.html#ga6156fe0b594c9754f386f6c6a30c8165">bool</a> zoErrorIsEmpty </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_z_o___e_r_r_o_r.html">ZO_ERROR</a> *&nbsp;</td>
          <td class="paramname"> <em>p</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Checks if the error buffer is empty. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>*p</em>&nbsp;</td><td>Pointer to the error buffer variable. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>true if the error buffer is empty, false if it isn't </dd></dl>

</div>
</div>
</div>
<hr class="footer"/><address style="text-align: right;"><small>Generated on Thu Mar 11 21:20:43 2010 for 01 Mechatronics Avr Library by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.3 </small></address>
</body>
</html>
