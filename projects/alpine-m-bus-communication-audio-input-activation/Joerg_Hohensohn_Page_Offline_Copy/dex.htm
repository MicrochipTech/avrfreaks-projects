<html xmlns:v="urn:schemas-microsoft-com:vml" xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:w="urn:schemas-microsoft-com:office:word" xmlns:st1="urn:schemas-microsoft-com:office:smarttags" xmlns="http://www.w3.org/TR/REC-html40"><head>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
<meta name="ProgId" content="Word.Document">
<meta name="Generator" content="Microsoft Word 10">
<meta name="Originator" content="Microsoft Word 10">
<link rel="File-List" href="filelist.xml" tppabs="http://joerg.hohensohn.bei.t-online.de/mbus/index-Dateien/filelist.xml">
<link rel="Edit-Time-Data" href="editdata.mso" tppabs="http://joerg.hohensohn.bei.t-online.de/mbus/index-Dateien/editdata.mso"><!--[if !mso]>
<style>
v\:* {behavior:url(#default#VML);}
o\:* {behavior:url(#default#VML);}
w\:* {behavior:url(#default#VML);}
.shape {behavior:url(#default#VML);}
</style>
<![endif]-->


<title>The Alpine M-Bus Protocol</title><o:smarttagtype namespaceuri="urn:schemas-microsoft-com:office:smarttags" name="place"></o:smarttagtype><!--[if gte mso 9]><xml>
 <o:DocumentProperties>
  <o:Author>.</o:Author>
  <o:LastAuthor>.</o:LastAuthor>
  <o:Revision>16</o:Revision>
  <o:Created>2003-05-12T06:03:00Z</o:Created>
  <o:LastSaved>2004-05-05T07:41:00Z</o:LastSaved>
  <o:Pages>1</o:Pages>
  <o:Words>1301</o:Words>
  <o:Characters>8199</o:Characters>
  <o:Lines>68</o:Lines>
  <o:Paragraphs>18</o:Paragraphs>
  <o:CharactersWithSpaces>9482</o:CharactersWithSpaces>
  <o:Version>10.2625</o:Version>
 </o:DocumentProperties>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:WordDocument>
  <w:SpellingState>Clean</w:SpellingState>
  <w:GrammarState>Clean</w:GrammarState>
  <w:HyphenationZone>21</w:HyphenationZone>
  <w:Compatibility>
   <w:BreakWrappedTables/>
   <w:SnapToGridInCell/>
   <w:WrapTextWithPunct/>
   <w:UseAsianBreakRules/>
   <w:UseFELayout/>
  </w:Compatibility>
  <w:BrowserLevel>MicrosoftInternetExplorer4</w:BrowserLevel>
 </w:WordDocument>
</xml><![endif]--><!--[if !mso]><object
 classid="clsid:38481807-CA0E-42D2-BF39-B33AF135CC4D" id=ieooui></object>
<style>
st1\:*{behavior:url(#ieooui) }
</style>
<![endif]-->

<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:SimSun;
	panose-1:2 1 6 0 3 1 1 1 1 1;
	mso-font-alt:\5B8B\4F53;
	mso-font-charset:134;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:3 135135232 16 0 262145 0;}
@font-face
	{font-family:"\@SimSun";
	panose-1:2 1 6 0 3 1 1 1 1 1;
	mso-font-charset:134;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:3 135135232 16 0 262145 0;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-parent:"";
	margin:0cm;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:SimSun;}
h1
	{mso-style-next:Standard;
	margin-top:12.0pt;
	margin-right:0cm;
	margin-bottom:3.0pt;
	margin-left:0cm;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:1;
	font-size:16.0pt;
	font-family:Arial;
	mso-font-kerning:16.0pt;}
h2
	{mso-style-next:Standard;
	margin-top:12.0pt;
	margin-right:0cm;
	margin-bottom:3.0pt;
	margin-left:0cm;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:2;
	font-size:14.0pt;
	font-family:Arial;
	font-style:italic;}
h3
	{mso-style-next:Standard;
	margin-top:12.0pt;
	margin-right:0cm;
	margin-bottom:3.0pt;
	margin-left:0cm;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:3;
	font-size:13.0pt;
	font-family:Arial;}
p.MsoTitle, li.MsoTitle, div.MsoTitle
	{margin-top:12.0pt;
	margin-right:0cm;
	margin-bottom:3.0pt;
	margin-left:0cm;
	text-align:center;
	mso-pagination:widow-orphan;
	mso-outline-level:1;
	font-size:16.0pt;
	font-family:Arial;
	mso-fareast-font-family:SimSun;
	mso-font-kerning:14.0pt;
	font-weight:bold;}
a:link, span.MsoHyperlink
	{color:blue;
	text-decoration:underline;
	text-underline:single;}
a:visited, span.MsoHyperlinkFollowed
	{color:purple;
	text-decoration:underline;
	text-underline:single;}
span.SpellE
	{mso-style-name:"";
	mso-spl-e:yes;}
span.GramE
	{mso-style-name:"";
	mso-gram-e:yes;}
@page Section1
	{size:595.3pt 841.9pt;
	margin:70.85pt 70.85pt 2.0cm 70.85pt;
	mso-header-margin:35.4pt;
	mso-footer-margin:35.4pt;
	mso-paper-source:0;}
div.Section1
	{page:Section1;}
-->
</style><!--[if gte mso 10]>
<style>
 /* Style Definitions */
 table.MsoNormalTable
	{mso-style-name:"Normale Tabelle";
	mso-tstyle-rowband-size:0;
	mso-tstyle-colband-size:0;
	mso-style-noshow:yes;
	mso-style-parent:"";
	mso-padding-alt:0cm 5.4pt 0cm 5.4pt;
	mso-para-margin:0cm;
	mso-para-margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";}
table.MsoTableGrid
	{mso-style-name:Tabellengitternetz;
	mso-tstyle-rowband-size:0;
	mso-tstyle-colband-size:0;
	border:solid windowtext 1.0pt;
	mso-border-alt:solid windowtext .5pt;
	mso-padding-alt:0cm 5.4pt 0cm 5.4pt;
	mso-border-insideh:.5pt solid windowtext;
	mso-border-insidev:.5pt solid windowtext;
	mso-para-margin:0cm;
	mso-para-margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";}
</style>
<![endif]--><!--[if gte mso 9]><xml>
 <o:shapedefaults v:ext="edit" spidmax="4098"/>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <o:shapelayout v:ext="edit">
  <o:idmap v:ext="edit" data="1"/>
 </o:shapelayout></xml><![endif]--></head>

<body style="" lang="DE" link="blue" vlink="purple">

<div class="Section1">

<p class="MsoTitle"><span style="" lang="EN-GB">The Alpine
M-Bus Protocol<o:p></o:p></span></p>

<p class="MsoNormal"><span style="" lang="EN-GB">Last
change: 2004/05/05 (link chapter)<o:p></o:p></span></p>

<h1><span style="" lang="EN-GB">Overview<o:p></o:p></span></h1>

<p class="MsoNormal"><span style="" lang="EN-GB">The M-Bus
is the old connection between Alpine <span class="SpellE">headunits</span> and CD
changers, the DIN-style circular plug. I don’t know much about its history, usage
for other brands, etc. (Volvo and Sherwood are among it.) I just had to need to
hack it in order to connect an MP3-player instead of a changer to the radio, so
I started measuring. Below is what I found out with my gear (9294 head unit,
5952 changer), your mileage may vary.<o:p></o:p></span></p>

<h1><span style="" lang="EN-GB">Electrical Characteristics<o:p></o:p></span></h1>

<p class="MsoNormal"><span style="" lang="EN-GB">The bus
uses a single wire and half duplex transmission. At both the radio and the CD
changer end it is pulled high to about 10 volts idle level, with resistors in
the range of 1800 Ohms. Both devices can now drive the bus low with their open
collector outputs.<o:p></o:p></span></p>

<p class="MsoNormal"><span style="" lang="EN-GB">So it is
not really TTL friendly. I used a piece of circuitry like below on my end, to
feed it into a microcontroller:<o:p></o:p></span></p>

<p class="MsoNormal"><span style="" lang="EN-GB"><img id="_x0000_i1025" src="schematic.gif" tppabs="http://www.jevinskie.org/genmay/mbus/index_files/schematic.gif" height="337" width="300"><o:p></o:p></span></p>

<p class="MsoNormal"><span style="" lang="EN-GB"><o:p>&nbsp;</o:p></span></p>

<h1><span style="" lang="EN-GB">Logical Layer<o:p></o:p></span></h1>

<p class="MsoNormal"><span style="" lang="EN-GB">The line
coding is unusual. It’s none of the textbook codes, instead some kind of pulse
width modulation. A short low pulse (about 0.6 ms) is a binary <span class="GramE">zero,</span> a longer pulse (about 1.8 ms) is a one. The distance
between the pulses remains <span class="GramE">constant,</span> about 3 ms. The
resulting baud rate is about 325 baud, fairly slow.<o:p></o:p></span></p>

<p class="MsoNormal"><span style="" lang="EN-GB"><img id="_x0000_i1026" src="LineCode.gif" tppabs="http://www.jevinskie.org/genmay/mbus/index_files/LineCode.gif" height="140" width="494"><o:p></o:p></span></p>

<p class="MsoNormal"><span style="" lang="EN-GB">In other
words, a bit starts with a falling edge, then the line is held low for 0.6 or
1.8 ms. The next bit starts after 3 ms, if there is more.<o:p></o:p></span></p>

<p class="MsoNormal"><span style="" lang="EN-GB">Bits are
grouped to packets, with length always multiple of 4 bits. So it makes sense to
write down packets with hexadecimal digits. The most significant bit is
transmitted first, so they are in left to right reading order. A packet ends
when no more bits are transmitted back to back within the bit time<span class="GramE">,<span style="">&nbsp; </span>when</span> the line stays
high.<o:p></o:p></span></p>

<p class="MsoNormal"><span style="" lang="EN-GB">The packets
I’ve seen are 12 to 64 bits long, 3 to 16 hex digits. The first digit (the
first 4 bit) is some kind of <span class="GramE">address,</span> it is always ‘9’
if coming from the changer, and ‘1’ if coming from the head unit. The last
digit is a checksum. It took me quite a while to figure out how it is
calculated, but the end result is simple: XOR of all hex digits excluding the
checksum, add ‘1’ (may wrap from ‘F’ to ‘0’).<o:p></o:p></span></p>

<p class="MsoNormal"><span style="" lang="EN-GB">Here’s an
example of the <span class="GramE">most simple</span> packet sent by the radio,
I’ve called it the ‘ping’ packet:<o:p></o:p></span></p>

<p class="MsoNormal"><span style="" lang="EN-GB"><o:p>&nbsp;</o:p></span></p>

<table class="MsoTableGrid" style="border: medium none ; width: 311.4pt; border-collapse: collapse;" border="1" cellpadding="0" cellspacing="0" width="415">
 <tbody><tr style="">
  <td style="border: 1pt solid windowtext; padding: 0cm 5.4pt; width: 95.4pt;" valign="top" width="127">
  <p class="MsoNormal"><b style=""><span style="" lang="EN-GB">Hex description<o:p></o:p></span></b></p>
  </td>
  <td colspan="4" style="border-style: solid solid solid none; border-color: windowtext windowtext windowtext -moz-use-text-color; border-width: 1pt 1pt 1pt medium; padding: 0cm 5.4pt; width: 72pt;" valign="top" width="96">
  <p class="MsoNormal" style="text-align: center;" align="center"><b style=""><span style="" lang="EN-GB">address<o:p></o:p></span></b></p>
  </td>
  <td colspan="4" style="border-style: solid solid solid none; border-color: windowtext windowtext windowtext -moz-use-text-color; border-width: 1pt 1pt 1pt medium; padding: 0cm 5.4pt; width: 72pt;" valign="top" width="96">
  <p class="MsoNormal" style="text-align: center;" align="center"><b style=""><span style="" lang="EN-GB">command<o:p></o:p></span></b></p>
  </td>
  <td colspan="4" style="border-style: solid solid solid none; border-color: windowtext windowtext windowtext -moz-use-text-color; border-width: 1pt 1pt 1pt medium; padding: 0cm 5.4pt; width: 72pt;" valign="top" width="96">
  <p class="MsoNormal" style="text-align: center;" align="center"><b style=""><span style="" lang="EN-GB">checksum<o:p></o:p></span></b></p>
  </td>
 </tr>
 <tr style="">
  <td style="border-style: none solid solid; border-color: -moz-use-text-color windowtext windowtext; border-width: medium 1pt 1pt; padding: 0cm 5.4pt; width: 95.4pt;" valign="top" width="127">
  <p class="MsoNormal"><b style=""><span style="" lang="EN-GB">Hex Digit<o:p></o:p></span></b></p>
  </td>
  <td colspan="4" style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 72pt;" valign="top" width="96">
  <p class="MsoNormal" style="text-align: center;" align="center"><span style="" lang="EN-GB">1<o:p></o:p></span></p>
  </td>
  <td colspan="4" style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 72pt;" valign="top" width="96">
  <p class="MsoNormal" style="text-align: center;" align="center"><span style="" lang="EN-GB">8<o:p></o:p></span></p>
  </td>
  <td colspan="4" style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 72pt;" valign="top" width="96">
  <p class="MsoNormal" style="text-align: center;" align="center"><span style="" lang="EN-GB">A<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style="">
  <td style="border-style: none solid solid; border-color: -moz-use-text-color windowtext windowtext; border-width: medium 1pt 1pt; padding: 0cm 5.4pt; width: 95.4pt;" valign="top" width="127">
  <p class="MsoNormal"><b style=""><span style="" lang="EN-GB">Binary Digit <o:p></o:p></span></b></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 18pt;" valign="top" width="24">
  <p class="MsoNormal" style="text-align: center;" align="center"><span style="" lang="EN-GB">0<o:p></o:p></span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 18pt;" valign="top" width="24">
  <p class="MsoNormal" style="text-align: center;" align="center"><span style="" lang="EN-GB">0<o:p></o:p></span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 18pt;" valign="top" width="24">
  <p class="MsoNormal" style="text-align: center;" align="center"><span style="" lang="EN-GB">0<o:p></o:p></span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 18pt;" valign="top" width="24">
  <p class="MsoNormal" style="text-align: center;" align="center"><span style="" lang="EN-GB">1<o:p></o:p></span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 18pt;" valign="top" width="24">
  <p class="MsoNormal" style="text-align: center;" align="center"><span style="" lang="EN-GB">1<o:p></o:p></span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 18pt;" valign="top" width="24">
  <p class="MsoNormal" style="text-align: center;" align="center"><span style="" lang="EN-GB">0<o:p></o:p></span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 18pt;" valign="top" width="24">
  <p class="MsoNormal" style="text-align: center;" align="center"><span style="" lang="EN-GB">0<o:p></o:p></span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 18pt;" valign="top" width="24">
  <p class="MsoNormal" style="text-align: center;" align="center"><span style="" lang="EN-GB">0<o:p></o:p></span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 18pt;" valign="top" width="24">
  <p class="MsoNormal" style="text-align: center;" align="center"><span style="" lang="EN-GB">1<o:p></o:p></span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 18pt;" valign="top" width="24">
  <p class="MsoNormal" style="text-align: center;" align="center"><span style="" lang="EN-GB">0<o:p></o:p></span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 18pt;" valign="top" width="24">
  <p class="MsoNormal" style="text-align: center;" align="center"><span style="" lang="EN-GB">1<o:p></o:p></span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 18pt;" valign="top" width="24">
  <p class="MsoNormal" style="text-align: center;" align="center"><span style="" lang="EN-GB">0<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style="">
  <td style="border-style: none solid solid; border-color: -moz-use-text-color windowtext windowtext; border-width: medium 1pt 1pt; padding: 0cm 5.4pt; width: 95.4pt;" valign="top" width="127">
  <p class="MsoNormal"><b style=""><span style="" lang="EN-GB">Bit description<o:p></o:p></span></b></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 18pt;" valign="top" width="24">
  <p class="MsoNormal" style="text-align: center;" align="center"><span style="" lang="EN-GB"><o:p>&nbsp;</o:p></span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 18pt;" valign="top" width="24">
  <p class="MsoNormal" style="text-align: center;" align="center"><span style="" lang="EN-GB"><o:p>&nbsp;</o:p></span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 18pt;" valign="top" width="24">
  <p class="MsoNormal" style="text-align: center;" align="center"><span style="" lang="EN-GB"><o:p>&nbsp;</o:p></span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 18pt;" valign="top" width="24">
  <p class="MsoNormal" style="text-align: center;" align="center"><span style="" lang="EN-GB"><o:p>&nbsp;</o:p></span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 18pt;" valign="top" width="24">
  <p class="MsoNormal" style="text-align: center;" align="center"><span style="" lang="EN-GB"><o:p>&nbsp;</o:p></span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 18pt;" valign="top" width="24">
  <p class="MsoNormal" style="text-align: center;" align="center"><span style="" lang="EN-GB"><o:p>&nbsp;</o:p></span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 18pt;" valign="top" width="24">
  <p class="MsoNormal" style="text-align: center;" align="center"><span style="" lang="EN-GB"><o:p>&nbsp;</o:p></span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 18pt;" valign="top" width="24">
  <p class="MsoNormal" style="text-align: center;" align="center"><span style="" lang="EN-GB"><o:p>&nbsp;</o:p></span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 18pt;" valign="top" width="24">
  <p class="MsoNormal" style="text-align: center;" align="center"><span style="" lang="EN-GB"><o:p>&nbsp;</o:p></span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 18pt;" valign="top" width="24">
  <p class="MsoNormal" style="text-align: center;" align="center"><span style="" lang="EN-GB"><o:p>&nbsp;</o:p></span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 18pt;" valign="top" width="24">
  <p class="MsoNormal" style="text-align: center;" align="center"><span style="" lang="EN-GB"><o:p>&nbsp;</o:p></span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 18pt;" valign="top" width="24">
  <p class="MsoNormal" style="text-align: center;" align="center"><span style="" lang="EN-GB"><o:p>&nbsp;</o:p></span></p>
  </td>
 </tr>
</tbody></table>

<p class="MsoNormal"><span style="" lang="EN-GB"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal"><span style="" lang="EN-GB">In the
following, I will use this style of table to document the packets I’ve seen. I
will omit the checksum, because for all packets containing data this will vary.<o:p></o:p></span></p>

<h1><span style="" lang="EN-GB">Command Reference<o:p></o:p></span></h1>

<p class="MsoNormal"><span style="" lang="EN-GB">I cannot give
a complete reference, only what I’ve seen with my equipment. I have named the
commands arbitrary. Corrections and additions welcome.<o:p></o:p></span></p>

<h2><st1:place><span style="" lang="EN-GB">Ping</span></st1:place><span style="" lang="EN-GB"><o:p></o:p></span></h2>

<table class="MsoTableGrid" style="border: medium none ; width: 239.4pt; border-collapse: collapse;" border="1" cellpadding="0" cellspacing="0" width="319">
 <tbody><tr style="">
  <td style="border: 1pt solid windowtext; padding: 0cm 5.4pt; width: 95.4pt;" valign="top" width="127">
  <p class="MsoNormal"><b style=""><span style="" lang="EN-GB">Hex description<o:p></o:p></span></b></p>
  </td>
  <td colspan="4" style="border-style: solid solid solid none; border-color: windowtext windowtext windowtext -moz-use-text-color; border-width: 1pt 1pt 1pt medium; padding: 0cm 5.4pt; width: 72pt;" valign="top" width="96">
  <p class="MsoNormal" style="text-align: center;" align="center"><b style=""><span style="" lang="EN-GB">address<o:p></o:p></span></b></p>
  </td>
  <td colspan="4" style="border-style: solid solid solid none; border-color: windowtext windowtext windowtext -moz-use-text-color; border-width: 1pt 1pt 1pt medium; padding: 0cm 5.4pt; width: 72pt;" valign="top" width="96">
  <p class="MsoNormal" style="text-align: center;" align="center"><b style=""><span style="" lang="EN-GB">command<o:p></o:p></span></b></p>
  </td>
 </tr>
 <tr style="">
  <td style="border-style: none solid solid; border-color: -moz-use-text-color windowtext windowtext; border-width: medium 1pt 1pt; padding: 0cm 5.4pt; width: 95.4pt;" valign="top" width="127">
  <p class="MsoNormal"><b style=""><span style="" lang="EN-GB">Hex Digit<o:p></o:p></span></b></p>
  </td>
  <td colspan="4" style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 72pt;" valign="top" width="96">
  <p class="MsoNormal" style="text-align: center;" align="center"><span style="" lang="EN-GB">1<o:p></o:p></span></p>
  </td>
  <td colspan="4" style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 72pt;" valign="top" width="96">
  <p class="MsoNormal" style="text-align: center;" align="center"><span style="" lang="EN-GB">8<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style="">
  <td style="border-style: none solid solid; border-color: -moz-use-text-color windowtext windowtext; border-width: medium 1pt 1pt; padding: 0cm 5.4pt; width: 95.4pt;" valign="top" width="127">
  <p class="MsoNormal"><b style=""><span style="" lang="EN-GB">Binary Digit <o:p></o:p></span></b></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 18pt;" valign="top" width="24">
  <p class="MsoNormal" style="text-align: center;" align="center"><span style="" lang="EN-GB">0<o:p></o:p></span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 18pt;" valign="top" width="24">
  <p class="MsoNormal" style="text-align: center;" align="center"><span style="" lang="EN-GB">0<o:p></o:p></span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 18pt;" valign="top" width="24">
  <p class="MsoNormal" style="text-align: center;" align="center"><span style="" lang="EN-GB">0<o:p></o:p></span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 18pt;" valign="top" width="24">
  <p class="MsoNormal" style="text-align: center;" align="center"><span style="" lang="EN-GB">1<o:p></o:p></span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 18pt;" valign="top" width="24">
  <p class="MsoNormal" style="text-align: center;" align="center"><span style="" lang="EN-GB">1<o:p></o:p></span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 18pt;" valign="top" width="24">
  <p class="MsoNormal" style="text-align: center;" align="center"><span style="" lang="EN-GB">0<o:p></o:p></span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 18pt;" valign="top" width="24">
  <p class="MsoNormal" style="text-align: center;" align="center"><span style="" lang="EN-GB">0<o:p></o:p></span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 18pt;" valign="top" width="24">
  <p class="MsoNormal" style="text-align: center;" align="center"><span style="" lang="EN-GB">0<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style="">
  <td style="border-style: none solid solid; border-color: -moz-use-text-color windowtext windowtext; border-width: medium 1pt 1pt; padding: 0cm 5.4pt; width: 95.4pt;" valign="top" width="127">
  <p class="MsoNormal"><b style=""><span style="" lang="EN-GB">Bit description<o:p></o:p></span></b></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 18pt;" valign="top" width="24">
  <p class="MsoNormal" style="text-align: center;" align="center"><span style="" lang="EN-GB"><o:p>&nbsp;</o:p></span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 18pt;" valign="top" width="24">
  <p class="MsoNormal" style="text-align: center;" align="center"><span style="" lang="EN-GB"><o:p>&nbsp;</o:p></span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 18pt;" valign="top" width="24">
  <p class="MsoNormal" style="text-align: center;" align="center"><span style="" lang="EN-GB"><o:p>&nbsp;</o:p></span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 18pt;" valign="top" width="24">
  <p class="MsoNormal" style="text-align: center;" align="center"><span style="" lang="EN-GB"><o:p>&nbsp;</o:p></span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 18pt;" valign="top" width="24">
  <p class="MsoNormal" style="text-align: center;" align="center"><span style="" lang="EN-GB"><o:p>&nbsp;</o:p></span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 18pt;" valign="top" width="24">
  <p class="MsoNormal" style="text-align: center;" align="center"><span style="" lang="EN-GB"><o:p>&nbsp;</o:p></span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 18pt;" valign="top" width="24">
  <p class="MsoNormal" style="text-align: center;" align="center"><span style="" lang="EN-GB"><o:p>&nbsp;</o:p></span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 18pt;" valign="top" width="24">
  <p class="MsoNormal" style="text-align: center;" align="center"><span style="" lang="EN-GB"><o:p>&nbsp;</o:p></span></p>
  </td>
 </tr>
</tbody></table>

<p class="MsoNormal"><span style="" lang="EN-GB">This is
sent by the radio if nothing else is to by said and done, to keep the
communication alive. The expected response from the changer is ‘Ping OK’.<o:p></o:p></span></p>

<h2><st1:place><span style="" lang="EN-GB">Ping</span></st1:place><span style="" lang="EN-GB"> OK<o:p></o:p></span></h2>

<table class="MsoTableGrid" style="border: medium none ; width: 239.4pt; border-collapse: collapse;" border="1" cellpadding="0" cellspacing="0" width="319">
 <tbody><tr style="">
  <td style="border: 1pt solid windowtext; padding: 0cm 5.4pt; width: 95.4pt;" valign="top" width="127">
  <p class="MsoNormal"><b style=""><span style="" lang="EN-GB">Hex description<o:p></o:p></span></b></p>
  </td>
  <td colspan="4" style="border-style: solid solid solid none; border-color: windowtext windowtext windowtext -moz-use-text-color; border-width: 1pt 1pt 1pt medium; padding: 0cm 5.4pt; width: 72pt;" valign="top" width="96">
  <p class="MsoNormal" style="text-align: center;" align="center"><b style=""><span style="" lang="EN-GB">address<o:p></o:p></span></b></p>
  </td>
  <td colspan="4" style="border-style: solid solid solid none; border-color: windowtext windowtext windowtext -moz-use-text-color; border-width: 1pt 1pt 1pt medium; padding: 0cm 5.4pt; width: 72pt;" valign="top" width="96">
  <p class="MsoNormal" style="text-align: center;" align="center"><b style=""><span style="" lang="EN-GB">command<o:p></o:p></span></b></p>
  </td>
 </tr>
 <tr style="">
  <td style="border-style: none solid solid; border-color: -moz-use-text-color windowtext windowtext; border-width: medium 1pt 1pt; padding: 0cm 5.4pt; width: 95.4pt;" valign="top" width="127">
  <p class="MsoNormal"><b style=""><span style="" lang="EN-GB">Hex Digit<o:p></o:p></span></b></p>
  </td>
  <td colspan="4" style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 72pt;" valign="top" width="96">
  <p class="MsoNormal" style="text-align: center;" align="center"><span style="" lang="EN-GB">9<o:p></o:p></span></p>
  </td>
  <td colspan="4" style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 72pt;" valign="top" width="96">
  <p class="MsoNormal" style="text-align: center;" align="center"><span style="" lang="EN-GB">8<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style="">
  <td style="border-style: none solid solid; border-color: -moz-use-text-color windowtext windowtext; border-width: medium 1pt 1pt; padding: 0cm 5.4pt; width: 95.4pt;" valign="top" width="127">
  <p class="MsoNormal"><b style=""><span style="" lang="EN-GB">Binary Digit <o:p></o:p></span></b></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 18pt;" valign="top" width="24">
  <p class="MsoNormal" style="text-align: center;" align="center"><span style="" lang="EN-GB">1<o:p></o:p></span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 18pt;" valign="top" width="24">
  <p class="MsoNormal" style="text-align: center;" align="center"><span style="" lang="EN-GB">0<o:p></o:p></span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 18pt;" valign="top" width="24">
  <p class="MsoNormal" style="text-align: center;" align="center"><span style="" lang="EN-GB">0<o:p></o:p></span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 18pt;" valign="top" width="24">
  <p class="MsoNormal" style="text-align: center;" align="center"><span style="" lang="EN-GB">1<o:p></o:p></span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 18pt;" valign="top" width="24">
  <p class="MsoNormal" style="text-align: center;" align="center"><span style="" lang="EN-GB">1<o:p></o:p></span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 18pt;" valign="top" width="24">
  <p class="MsoNormal" style="text-align: center;" align="center"><span style="" lang="EN-GB">0<o:p></o:p></span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 18pt;" valign="top" width="24">
  <p class="MsoNormal" style="text-align: center;" align="center"><span style="" lang="EN-GB">0<o:p></o:p></span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 18pt;" valign="top" width="24">
  <p class="MsoNormal" style="text-align: center;" align="center"><span style="" lang="EN-GB">0<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style="">
  <td style="border-style: none solid solid; border-color: -moz-use-text-color windowtext windowtext; border-width: medium 1pt 1pt; padding: 0cm 5.4pt; width: 95.4pt;" valign="top" width="127">
  <p class="MsoNormal"><b style=""><span style="" lang="EN-GB">Bit description<o:p></o:p></span></b></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 18pt;" valign="top" width="24">
  <p class="MsoNormal" style="text-align: center;" align="center"><span style="" lang="EN-GB"><o:p>&nbsp;</o:p></span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 18pt;" valign="top" width="24">
  <p class="MsoNormal" style="text-align: center;" align="center"><span style="" lang="EN-GB"><o:p>&nbsp;</o:p></span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 18pt;" valign="top" width="24">
  <p class="MsoNormal" style="text-align: center;" align="center"><span style="" lang="EN-GB"><o:p>&nbsp;</o:p></span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 18pt;" valign="top" width="24">
  <p class="MsoNormal" style="text-align: center;" align="center"><span style="" lang="EN-GB"><o:p>&nbsp;</o:p></span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 18pt;" valign="top" width="24">
  <p class="MsoNormal" style="text-align: center;" align="center"><span style="" lang="EN-GB"><o:p>&nbsp;</o:p></span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 18pt;" valign="top" width="24">
  <p class="MsoNormal" style="text-align: center;" align="center"><span style="" lang="EN-GB"><o:p>&nbsp;</o:p></span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 18pt;" valign="top" width="24">
  <p class="MsoNormal" style="text-align: center;" align="center"><span style="" lang="EN-GB"><o:p>&nbsp;</o:p></span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 18pt;" valign="top" width="24">
  <p class="MsoNormal" style="text-align: center;" align="center"><span style="" lang="EN-GB"><o:p>&nbsp;</o:p></span></p>
  </td>
 </tr>
</tbody></table>

<p class="MsoNormal"><span style="" lang="EN-GB">This is
sent by the changer in response to a ping packet.<o:p></o:p></span></p>

<p class="MsoNormal"><span style="" lang="EN-GB"><o:p>&nbsp;</o:p></span></p>

  <p class="MsoNormal"><span style="" lang="EN-GB">I preferred Excel for the “real” 
    documentation of the commands, so <a href="Protocol.xls">here’s</a> the detailed 
    reference. I have not made a documentation about the semantic of the commands, 
    sorry.<o:p></o:p></span></p>

<h1><span style="" lang="EN-GB">Tools<o:p></o:p></span></h1>

<p class="MsoNormal"><span style="" lang="EN-GB">When I worked
on this, I made myself some tooling to tackle the bus.<o:p></o:p></span></p>

<h2><span style="" lang="EN-GB">M-Bus<span style="">&nbsp; </span>&lt;-&gt;<span style="">&nbsp;
</span>RS232 Converter<o:p></o:p></span></h2>

<p class="MsoNormal"><span style="" lang="EN-GB"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal"><span style="" lang="EN-GB">The first
“product” is an <span class="SpellE">Atmel</span> microcontroller implementation
of the physical and logical layer. It can listen on the M-Bus side and send it
out again as a hex dump via RS232. Packets are separated with a linefeed. For
the other direction, it receives and collects hex dump chars from the RS232.
When a packet is “terminated” with a linefeed, it will be sent out to the
M-Bus.<o:p></o:p></span></p>

<p class="MsoNormal"><span style="" lang="EN-GB">For most
applications, this is all you need. The converter allows to talk with the M-Bus
via an RS232 link. A terminal program can be used for fist steps.<o:p></o:p></span></p>

<h3><span style="" lang="EN-GB">Hardware<o:p></o:p></span></h3>

<p class="MsoNormal"><span style="" lang="EN-GB"><img id="_x0000_i1027" src="mbus_dongle.jpg" tppabs="http://www.jevinskie.org/genmay/mbus/index_files/mbus_dongle.jpg" border="0" height="425" width="604"><o:p></o:p></span></p>

<p class="MsoNormal"><span style="" lang="EN-GB">On the left
is the DB9 jack for RS232, right is a connector for the M-Bus (ground, bus,
12V). The M-Bus supplies the power. On the top is the connector for in-circuit
programming the board. The design is very straightforward. The <span class="SpellE">Atmel</span> 90S2313 is clocked by a 7.3728 MHz <span class="SpellE">chrystal</span>, which allows nice <span class="SpellE">baudrate</span>
generation. Default is 115200 Baud, but can be changed in the EEPROM space of
the controller. The transistors close to the BD9 jack are for level conversion
(no MAX232), on the upper right is a 5V regulator, beneath that the open
collector driver for the bus.<o:p></o:p></span></p>

<p class="MsoNormal"><span style="" lang="EN-GB">My
prototyping board is a little bit different than the schematics below
(free-hand drawn with Eagle PCB, not proofed), because I use my own non-standard
ISP connector. Below is compliant with the “official” STK200/300 programming
cable. There is a very simple cable variant for the printer port out somewhere
in the web (can’t find it right now) which does not require active components,
just a few resistors and diodes. That’s the kind I use.<o:p></o:p></span></p>

<p class="MsoNormal"><span style="" lang="EN-GB"><img id="_x0000_i1028" src="schematics.gif" tppabs="http://www.jevinskie.org/genmay/mbus/index_files/schematics.gif" border="0" height="429" width="850"><o:p></o:p></span></p>

<p class="MsoNormal"><span style="" lang="EN-GB">The
transistors can be practically any small signal NPN <span class="GramE">type,</span>
I just pulled some out of the box. Same goes for the diode D1. But D2 needs to
be a <span class="SpellE">Zener</span> diode with 4.7 Volts threshold. The
connections to the crystal pins should be short.<o:p></o:p></span></p>

  <p class="MsoNormal">&nbsp;</p>
  <p class="MsoNormal"><span style="" lang="EN-GB">Software<o:p></o:p></span></p>
  <p class="MsoNormal"><span style="" lang="EN-GB"><a href="mbus_dongle_source.zip">Here</a> 
    is the software running on my “M-Bus Dongle”. It also compiles on an AT Mega8 
    device, if you prefer that. I have compiled it with <a href="javascript:if(confirm('http://www.avrfreaks.org/AVRGCC/index.php  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.avrfreaks.org/AVRGCC/index.php'" tppabs="http://www.avrfreaks.org/AVRGCC/index.php">Gnu-C 
    for <span class="SpellE">Atmel</span></a>. Hex files for both controllers 
    and sources are included. I use <a href="javascript:if(confirm('http://www.lancos.com/prog.html  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.lancos.com/prog.html'" tppabs="http://www.lancos.com/prog.html"><span class="SpellE">PonyProg</span></a> 
    to program the hex files.<o:p></o:p></span></p>

<p class="MsoNormal"><span style="" lang="EN-GB"><o:p>&nbsp;</o:p></span></p>

<h2><span style="" lang="EN-GB">M-Bus Monitor Application<o:p></o:p></span></h2>

  <p class="MsoNormal"><span style="" lang="EN-GB">For learning more about the 
    bus, the terminal output is not so nice for humans. For this reason, I made 
    a (Windows MFC) application which displays the hex log together with a readable 
    interpretation, plus an icon indicating the source and status, plus timestamp 
    information. Credits for the serial communication class go to <a href="http://www.codeproject.com/internet/tserial_event.asp">Thierry 
    Schneider</a>.<o:p></o:p></span></p>

<p class="MsoNormal"><span style="" lang="EN-GB"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal"><span style="" lang="EN-GB"><img id="_x0000_i1029" src="monitor.gif" tppabs="http://www.jevinskie.org/genmay/mbus/index_files/monitor.gif" border="0" height="568" width="605"><o:p></o:p></span></p>

<p class="MsoNormal"><span style="" lang="EN-GB"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal"><span style="" lang="EN-GB">The
application first was a pure passive monitor, telling what’s going on at the
bus. Later it got a second mode (shown at work above), where it emulates a
changer, cheating the radio. With the changer class I learned what the <span class="SpellE">headunit</span> really wants to hear, versus what info from the
changer is babble.<o:p></o:p></span></p>

<p class="MsoNormal"><span style="" lang="EN-GB"><o:p>&nbsp;</o:p></span></p>

  <p class="MsoNormal"><span style="" lang="EN-GB">Source and executable for the 
    program are <a href="mbus_monitor.zip">here</a>. I have plenty of real-world 
    <a href="Logs.zip">logs</a> for various changer states, but from various phases 
    of the project and not in a consistently documented shape. Some have delta 
    timestamps in the first column, some are very raw. I hope it still helps.<o:p></o:p></span></p>

<h1><span style="" lang="EN-GB">Why Am I doing this?<o:p></o:p></span></h1>

<p class="MsoNormal"><span style="" lang="EN-GB">Maybe
you’re curious why I went through all that trouble and give out all that info
and sources for free (I hope Alpine won’t mind). I have an ongoing project of
connecting an <span class="SpellE">Archos</span> mp3-player as an alternative to
the “real” changer. I’ve heavily searched the web for M-Bus info, but nobody
(except one guy to <span class="SpellE">who’m</span> I couldn’t get contact)
seemed to have hacked with the older Alpine gear. So I had to try it on my own.
Many other people did valuable stuff in their free time that was of good use to
me (like the <span class="SpellE">Atmel</span> tooling), so I’d like to give
something back to the community, hoping it can be reused. I’d kindly appreciate
a status notification if so (robot-cloaked email address: <span class="SpellE">joergDOThohensohnATgmxDOTde</span>).<o:p></o:p></span></p>

<h1><span style="" lang="EN-GB">Links<o:p></o:p></span></h1>

<p class="MsoNormal"><span style="" lang="EN-GB">My postings
about it to the <span class="SpellE">Archos</span> <span class="SpellE">Rockbox</span>
group:<o:p></o:p></span></p>

<p class="MsoNormal"><span style="" lang="EN-GB"><a href="javascript:if(confirm('http://rockbox.haxx.se/mail/archive/rockbox-archive-2003-11/0476.shtml  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://rockbox.haxx.se/mail/archive/rockbox-archive-2003-11/0476.shtml'" tppabs="http://rockbox.haxx.se/mail/archive/rockbox-archive-2003-11/0476.shtml">http://rockbox.haxx.se/mail/archive/rockbox-archive-2003-11/0476.shtml</a><o:p></o:p></span></p>

<p class="MsoNormal"><span style="" lang="EN-GB"><a href="javascript:if(confirm('http://rockbox.haxx.se/mail/archive/rockbox-archive-2004-01/0778.shtml  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://rockbox.haxx.se/mail/archive/rockbox-archive-2004-01/0778.shtml'" tppabs="http://rockbox.haxx.se/mail/archive/rockbox-archive-2004-01/0778.shtml">http://rockbox.haxx.se/mail/archive/rockbox-archive-2004-01/0778.shtml</a><o:p></o:p></span></p>

<p class="MsoNormal"><span style="" lang="EN-GB"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal"><span class="SpellE"><span style="" lang="EN-GB">Marek</span></span><span style="" lang="EN-GB"> <span class="SpellE">Debowski</span> made a controller box for his changer:<o:p></o:p></span></p>

<p class="MsoNormal"><span style="" lang="EN-GB"><a href="javascript:if(confirm('http://www.cdchangeren.prv.pl/  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.cdchangeren.prv.pl/'" tppabs="http://www.cdchangeren.prv.pl/">http://www.cdchangeren.prv.pl/</a><o:p></o:p></span></p>

<p class="MsoNormal"><span style="" lang="EN-GB"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal"><span style="" lang="EN-GB">Later I
learned about this parallel activity (would have saved me a lot of work)<o:p></o:p></span></p>

<p class="MsoNormal"><span style="" lang="EN-GB"><a href="javascript:if(confirm('http://kiora.ath.cx/alpine/  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://kiora.ath.cx/alpine/'" tppabs="http://kiora.ath.cx/alpine/">http://kiora.ath.cx/alpine/</a><o:p></o:p></span></p>

<p class="MsoNormal"><span style="" lang="EN-GB"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal"><span class="SpellE"><span style="" lang="EN-GB">Mictronics</span></span><span style="" lang="EN-GB">
has links to various CD changer protocols:<o:p></o:p></span></p>

<p class="MsoNormal"><span style="" lang="EN-GB"><a href="javascript:if(confirm('http://www.mictronics.de/?page=cdc_proto  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.mictronics.de/?page=cdc_proto'" tppabs="http://www.mictronics.de/?page=cdc_proto">http://www.mictronics.de/?page=cdc_proto</a><o:p></o:p></span></p>

<p class="MsoNormal"><span style="" lang="EN-GB"><o:p>&nbsp;</o:p></span></p>

</div>

</body></html>